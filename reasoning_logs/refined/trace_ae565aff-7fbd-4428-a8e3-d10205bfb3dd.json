{
    "trace_id": "ae565aff-7fbd-4428-a8e3-d10205bfb3dd",
    "final_answer": "<solution>\nReasoning and approach  \nYou want a focused CRISPR perturbation screen where the phenotype is not ‚ÄúTCR signaling‚Äù per se, but the *difference* in TCR signaling between acute (IL‚Äë2 only) and chronic (anti‚ÄëCD3 + IL‚Äë2) stimulation. The most informative genes, therefore, are those that (i) drive the chronic-adaptation/exhaustion program (NFAT‚ÜíTOX/NR4A, AP‚Äë1 imbalance, etc.), (ii) implement inhibitory feedback that accumulates during chronic stimulation (ubiquitin ligases, phosphatases, diacylglycerol kinases, SOCS/A20), and (iii) are canonical checkpoint receptors that become functional brakes in chronic contexts. I‚Äôll design a screen around an interaction (‚Äúdifference-in-differences‚Äù) effect and propose 32 genes expected to produce large shifts in that interaction.\n\nPlan (checklist)\n1. [ ] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [ ] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change\n\n1) Define the phenotype (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [ ] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nPhenotype definition (practical options):\n- Primary phenotype (recommended): a flow-cytometry TCR signaling reporter measured after a standardized brief re-stimulation pulse, e.g.  \n  - pERK (MAPK), pZAP70, pS6 (mTOR output), NFAT nuclear localization, or a transcriptional immediate-early marker such as CD69.  \n- Key design: measure signaling *the same way* in both arms, then score each perturbation by how much it changes the chronic-vs-acute signaling contrast.\n\n2) Screen format (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nRecommended screen structure (small, high-effect, 32 genes):\n- Perturbation: CRISPR knockout (CRISPRko) in human primary CD8 T cells (most physiologic for exhaustion-like states).  \n- Library size: 32 genes √ó 4 sgRNAs/gene (typical) + controls  \n  - Controls: ~10‚Äì20 non-targeting + a few positive controls for ‚Äúreduce signaling in both contexts‚Äù (e.g., proximal TCR genes) if desired.  \n- Delivery: pooled lentiviral sgRNA into Cas9-expressing T cells or sgRNA + Cas9 RNP approaches; keep infection low to favor 1 perturbation/cell.  \n- Replication: biological replicates across donors (at least 2‚Äì3 donors) are more valuable than extra technical replicates because exhaustion programs vary by donor.\n\n3) Timeline and stimulation arms (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nTwo-arm design (conceptual):\n- Arm A (Acute reference): IL‚Äë2 only culture (‚Äúrested/expanded, not chronically TCR-driven‚Äù).  \n- Arm B (Chronic): repeated or sustained anti‚ÄëCD3 stimulation with IL‚Äë2 to induce chronic activation/exhaustion-like adaptation.  \n- Measurement day: on the same day in both arms, apply an identical short anti‚ÄëCD3 restimulation pulse (or identical stimulation protocol) immediately before signaling readout, so the readout is comparable.\n\n4) Sorting/quantification strategy (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nPooled readout:\n- For each arm (Acute and Chronic), sort cells into at least two bins based on signaling after the standardized pulse:  \n  - High signaling vs Low signaling (e.g., top ~20‚Äì30% vs bottom ~20‚Äì30% of the chosen marker).  \n- Sequence sgRNA cassettes from each bin and quantify sgRNA enrichment/depletion.\n\n5) Scoring model for ‚Äúchange in signaling between acute and chronic‚Äù (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [‚úì] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nCompute a per-gene interaction score (difference-in-differences):\n- For each sgRNA (then aggregate to gene), compute:  \n  - Acute effect = log2( sgRNA abundance in High / Low ) in Acute arm  \n  - Chronic effect = log2( sgRNA abundance in High / Low ) in Chronic arm  \n- Interaction (your target metric) = Chronic effect ‚àí Acute effect  \nInterpretation:\n- Positive interaction: perturbation specifically increases signaling in chronic relative to acute (candidate ‚Äúexhaustion brake‚Äù genes; KO may preserve signaling under chronic stimulation).  \n- Negative interaction: perturbation specifically decreases signaling in chronic relative to acute (candidate ‚Äúresilience‚Äù genes; KO worsens chronic signaling collapse).\n\n6) 32 genes to maximize expected perturbation of acute‚Üíchronic TCR-signaling change (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [‚úì] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [‚úì] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nGene set (32), organized by mechanism (all human gene symbols):\n\nA) Core exhaustion/adaptation transcriptional drivers (large chronic-specific effects expected)\n1. TOX  \n2. TOX2  \n3. NR4A1  \n4. NR4A2  \n5. NR4A3  \n6. BATF  \n7. IRF4  \n8. PRDM1  \n9. IKZF2  \n10. TBX21  \n11. EOMES  \n12. TCF7  \n13. BACH2  \n\nB) Epigenetic/state-stabilizers (often convert chronic stimulation into a stable dysfunctional state)\n14. DNMT3A  \n15. TET2  \n16. EZH2  \n17. HDAC7  \n\nC) TCR negative-feedback enzymes (directly tune signaling amplitude; frequently upweighted in chronic contexts)\n18. PTPN2  \n19. PTPN6  \n20. PTPN11  \n21. DGKA  \n22. DGKZ  \n\nD) Ubiquitin/termination of activation signaling (chronic stimulation tends to select for strong signal-terminating feedback)\n23. CBLB  \n24. ITCH  \n25. RNF128  \n\nE) Inflammatory/TCR pathway brakes that can disproportionately matter in chronic stimulation\n26. TNFAIP3  \n27. SOCS1  \n\nF) Checkpoint receptors (canonical chronic brakes; KO often shifts chronic signaling strongly)\n28. PDCD1  \n29. CTLA4  \n30. TIGIT  \n31. LAG3  \n32. HAVCR2  \n\nIf you tell me (i) species (human vs mouse), (ii) CD4 vs CD8, and (iii) which signaling marker you want to sort on (pERK vs NFAT vs CD69, etc.), I can refine the design choices (e.g., which category to overweight) and propose how to prioritize ‚Äúpositive controls‚Äù vs ‚Äúdiscovery‚Äù targets within the same 32-gene library.\n</solution>",
    "messages": [
        {
            "id": null,
            "name": null,
            "type": "system",
            "content": "\nYou are Aigen R0, helpful biomedical assistant assigned with the task of problem-solving.\nTo achieve this, you will be using an interactive coding environment equipped with a variety of tool functions, data, and softwares to assist you throughout the process.\n\nGiven a task, make a plan first. The plan should be a numbered list of steps that you will take to solve the task. Be specific and detailed.\nFormat your plan as a checklist with empty checkboxes like this:\n1. [ ] First step\n2. [ ] Second step\n3. [ ] Third step\n\nFollow the plan step by step. After completing each step, update the checklist by replacing the empty checkbox with a checkmark:\n1. [‚úì] First step (completed)\n2. [ ] Second step\n3. [ ] Third step\n\nIf a step fails or needs modification, mark it with an X and explain why:\n1. [‚úì] First step (completed)\n2. [‚úó] Second step (failed because...)\n3. [ ] Modified second step\n4. [ ] Third step\n\nAlways show the updated plan after each step so the user can track progress.\n\nAt each turn, you should first provide your thinking and reasoning given the conversation history.\nAfter that, you have two options:\n\n1) Interact with a programming environment and receive the corresponding output within <observe></observe>. Your code should be enclosed using \"<execute>\" tag, for example: <execute> print(\"Hello World!\") </execute>. IMPORTANT: You must end the code block with </execute> tag.\n   - For Python code (default): <execute> print(\"Hello World!\") </execute>\n   - For R code: <execute> #!R\nlibrary(ggplot2)\nprint(\"Hello from R\") </execute>\n   - For Bash scripts and commands: <execute> #!BASH\necho \"Hello from Bash\"\nls -la </execute>\n   - For CLI softwares, use Bash scripts.\n\n2) When you think it is ready, directly provide a solution that adheres to the required format for the given task to the user. Your solution should be enclosed using \"<solution>\" tag, for example: The answer is <solution> A </solution>. IMPORTANT: You must end the solution block with </solution> tag.\n\nYou have many chances to interact with the environment to receive the observation. So you can decompose your code into multiple steps.\nDon't overcomplicate the code. Keep it simple and easy to understand.\nWhen writing the code, please print out the steps and results in a clear and concise manner, like a research log.\nWhen calling the existing python functions in the function dictionary, YOU MUST SAVE THE OUTPUT and PRINT OUT the result.\nFor example, result = understand_scRNA(XXX) print(result)\nOtherwise the system will not be able to know what has been done.\n\nFor R code, use the #!R marker at the beginning of your code block to indicate it's R code.\nFor Bash scripts and commands, use the #!BASH marker at the beginning of your code block. This allows for both simple commands and multi-line scripts with variables, loops, conditionals, loops, and other Bash features.\n\nIn each response, you must include EITHER <execute> or <solution> tag. Not both at the same time. Do not respond with messages without any tags. No empty messages.\n\nPROTOCOL GENERATION:\nIf the user requests an experimental protocol, use search_protocols(), advanced_web_search_claude(), list_local_protocols(), and read_local_protocol() to generate an accurate protocol. Include details such as reagents (with catalog numbers if available), equipment specifications, replicate requirements, error handling, and troubleshooting - but ONLY include information found in these resources. Do not make up specifications, catalog numbers, or equipment details. Prioritize accuracy over completeness.\n\n\nPRIORITY CUSTOM RESOURCES\n===============================\nIMPORTANT: The following custom resources have been specifically added for your use.\n    PRIORITIZE using these resources as they are directly relevant to your task.\n    Always consider these FIRST and in the meantime using default resources.\n\n\nüìö KNOW-HOW DOCUMENTS (BEST PRACTICES & PROTOCOLS - ALREADY LOADED):\nüìö sgRNA Design Guide: Three-Tiered Approach:\n# sgRNA Design Guide: Three-Tiered Approach\n\n## Citations and Acknowledgments\n\n### If you use validated sgRNAs from our database (Option 1):\n- **Database Source**: Addgene (https://www.addgene.org)\n- **Citation**: Always cite the original publication associated with each sgRNA using the PubMed ID provided in the database\n- **Acknowledgment**: \"Validated sgRNA sequences obtained from Addgene (https://www.addgene.org/crispr/reference/grna-sequence/)\"\n\n### If you use CRISPick designs (Option 2):\n- **Acknowledgment Statement**: \"Guide designs provided by the CRISPick web tool of the GPP at the Broad Institute\"\n- **Citation for Cas9 designs (SpCas9, SaCas9)**: Sanson KR, et al. Optimized libraries for CRISPR-Cas9 genetic screens with multiple modalities. Nat Commun. 2018;9(1):5416. PMID: 30575746\n- **Citation for Cas12a designs (AsCas12a, enAsCas12a)**: DeWeirdt PC, et al. Optimization of AsCas12a for combinatorial genetic screens in human cells. Nat Biotechnol. 2021;39(1):94-104. PMID: 32661438\n  - Note: This paper describes enAsCas12a optimization; specify which variant you used in your methods\n\n## Overview\n\nThis guide provides a three-tiered approach to sgRNA design, prioritizing validated sequences before moving to computational predictions. Always start with Option 1 and proceed to subsequent options only if needed.\n\n\n## Option 1: Search Validated sgRNA Sequences (Recommended First)\n\n### 1.1 Search for Validated sgRNAs\n\n**IMPORTANT**: You MUST complete BOTH Method 1 AND Method 2 before proceeding to Option 2. Do not skip Method 2 even if Method 1 finds no results.\n\n#### Method 1: Search Our Database (Fastest)\n\nWe maintain a curated database of 300+ validated sgRNA sequences from Addgene with experimental evidence.\n\n**Location**: `biomni/know_how/resource/addgene_grna_sequences.csv`\n\n**Search the database**:\n```python\nimport pandas as pd\n\n# Load the database\ndf = pd.read_csv('addgene_grna_sequences.csv')\n\n# Search for your gene\ngene_name = \"TP53\"\nresults = df[df['Target_Gene'].str.upper() == gene_name.upper()]\n\n# Filter by species and application\nresults_filtered = results[\n    (results['Target_Species'] == 'H. sapiens') &\n    (results['Application'] == 'cut')  # or 'activate', 'RNA targeting'\n]\n\n# Display results with references\nprint(results_filtered[['Target_Gene', 'Target_Sequence',\n                        'Plasmid_ID', 'PubMed_ID', 'Depositor']])\n```\n\n**Database columns**:\n- `Target_Gene`: Gene symbol\n- `Target_Species`: Organism (H. sapiens, M. musculus, etc.)\n- `Target_Sequence`: 20bp sgRNA sequence (5' to 3')\n- `Application`: cut (knockout), activate (CRISPRa), RNA targeting (CRISPRi)\n- `Cas9_Species`: S. pyogenes, S. aureus, etc.\n- `Plasmid_ID`: Addgene plasmid number\n- `Plasmid_URL`: Direct link to plasmid page\n- `PubMed_ID`: **Publication reference** (cite this in your work)\n- `PubMed_URL`: Direct link to paper\n- `Depositor`: Research lab that contributed the sequence\n\n#### Method 2: Advanced Web Search (REQUIRED - Do Not Skip)\n\n**CRITICAL**: Even if Method 1 found no results, you MUST perform this literature search before moving to Option 2. Many validated sgRNAs are published in literature but not in the Addgene database.\n\nUse `advanced_web_search_claude` from `biomni.tool.literature` to find validated sgRNAs from literature and databases:\n\n```python\nfrom biomni.tool.literature import advanced_web_search_claude\n\n# Example usage\nresults = advanced_web_search_claude(\"sgRNA TP53 validated H. sapiens experimental\")\n```\n\n**Search queries to try (use multiple):**\n```\n\"sgRNA\" OR \"guide RNA\" \"[GENE_NAME]\" validated experimental\n\"CRISPR knockout\" \"[GENE_NAME]\" sgRNA sequence validated\n\"[GENE_NAME]\" sgRNA \"cutting efficiency\" OR \"on-target\"\n\"[GENE_NAME]\" \"guide sequence\" CRISPR validated\n```\n\n**Example for TP53:**\n```\n\"sgRNA\" \"TP53\" validated \"H. sapiens\" experimental\n\"CRISPR knockout\" \"TP53\" guide sequence validated\n```\n\n**What to search for in results:**\n- Published papers with validated sgRNA sequences\n- Supplementary materials containing sgRNA sequences\n- Other CRISPR databases (e.g., GenScript, Horizon Discovery)\n- Laboratory protocols with specific sgRNA sequences\n\n**IMPORTANT**: Spend adequate time searching literature. Look through at least the first 10-15 search results and check supplementary materials of relevant papers.\n\n#### What to Do with Results:\n\n‚úÖ **If you find matching sgRNAs (from either method):**\n1. **Record the sgRNA sequence** (20bp target sequence)\n2. **Note the reference**:\n   - From database: Use `PubMed_ID` to cite the original paper\n   - From web search: Record the publication DOI/PubMed ID\n3. **Record validation details**: Cell line, cutting efficiency, any reported off-targets\n\n\n**Example result format:**\n```\nGene: TP53\nsgRNA sequence: GAGGTTGTGAGGCGCTGCCC\nSpecies: H. sapiens (human)\nApplication: Knockout (cut)\nReference: PubMed ID 24336569 (Ran et al., 2013)\nValidation: Tested in HEK293T cells, 85% cutting efficiency\n```\n\n‚ùå **If no matches found in BOTH Method 1 AND Method 2:**\nOnly then proceed to **Option 2: Download CRISPick Dataset**\n\n\n## Option 2: Download Pre-Computed sgRNAs from CRISPick\n\n### When to Use This Option?\n- No validated sgRNAs found in Addgene\n- Need comprehensive coverage of a gene\n- Want multiple sgRNA options with predicted scores\n- Working with genome-scale screening\n\n### 2.1 Overview of CRISPick\n\n**CRISPick** (from Broad Institute GPP) provides pre-computed sgRNA designs for entire genomes with 238 available datasets covering:\n- Human (GRCh38, GRCh37)\n- Mouse (GRCm38, GRCm39)\n- Dog, Cow, Monkey, and other model organisms\n- Multiple Cas enzymes (SpCas9, SaCas9, AsCas12a, enAsCas12a)\n  - **IMPORTANT**: AsCas12a and enAsCas12a are DIFFERENT enzymes\n  - **AsCas12a**: Wild-type Acidaminococcus sp. Cas12a\n  - **enAsCas12a**: Enhanced variant with improved activity\n  - **Critical**: sgRNAs designed for enAsCas12a may NOT work with wild-type AsCas12a\n  - Always match the dataset to your specific Cas12a variant\n- Different applications (knockout, activation, inhibition)\n\n### 2.2 Find the Download Link\n\n**All 238 download links are available in**: `biomni/know_how/resource/CRISPick_download_links.txt`\n\n#### Step 1: Understand File Naming Convention\n\nFiles are named: `sgRNA_design_{TAXID}_{GENOME}_{CAS}_{APPLICATION}_{ALGORITHM}_{SOURCE}_{DATE}.txt.gz`\n\n**Common datasets:**\n\n| Organism | Genome | Cas9 | Application | Search Pattern |\n|-|--||-|-|\n| Human | GRCh38 | SpCas9 | Knockout | `9606_GRCh38_SpyoCas9_CRISPRko` |\n| Human | GRCh38 | SpCas9 | Activation | `9606_GRCh38_SpyoCas9_CRISPRa` |\n| Human | GRCh38 | SaCas9 | Knockout | `9606_GRCh38_SaurCas9_CRISPRko` |\n| Mouse | GRCm38 | SpCas9 | Knockout | `10090_GRCm38_SpyoCas9_CRISPRko` |\n| Mouse | GRCm38 | SpCas9 | Activation | `10090_GRCm38_SpyoCas9_CRISPRa` |\n\n**Key components:**\n- **TAXID**: `9606` (Human), `10090` (Mouse), `9615` (Dog), `9913` (Cow)\n- **CAS**:\n  - `SpyoCas9` (SpCas9, NGG PAM)\n  - `SaurCas9` (SaCas9, NNGRRT PAM)\n  - `AsCas12a` (Wild-type Cas12a, TTTV PAM)\n  - `enAsCas12a` (Enhanced Cas12a, TTTV PAM)\n  - **WARNING**: Do NOT use AsCas12a datasets if you have enAsCas12a, and vice versa\n- **APPLICATION**: `CRISPRko` (knockout), `CRISPRa` (activation), `CRISPRi` (inhibition)\n\n#### Step 2: Find Your Download URL\n\n```bash\n# Search the download links file\ngrep \"9606_GRCh38_SpyoCas9_CRISPRko\" biomni/know_how/resource/CRISPick_download_links.txt\n\n# Or for mouse\ngrep \"10090_GRCm38_SpyoCas9_CRISPRko\" biomni/know_how/resource/CRISPick_download_links.txt\n```\n\n#### Step 3: Download and Extract\n\n```bash\n# Copy the URL from download_links.txt, then:\nwget [PASTE_URL_HERE]\n\n# Extract the file\ngunzip sgRNA_design_*.txt.gz\n```\n\n**File sizes**: Knockout (300-700 MB), Activation (50-100 MB), Summary files (1-3 MB)\n\n### 2.4 Understanding the File Format\n\nThe `.txt` file is tab-delimited. Column names differ between knockout and activation/inhibition datasets.\n\n**Essential Columns (All files):**\n- **sgRNA Sequence**: The 20bp guide RNA sequence (5' to 3')\n- **Target Gene Symbol**: Gene name (e.g., \"TP53\", \"BRCA1\")\n- **Combined Rank**: Overall ranking (lower = better) - **Use this by default**\n- **On-Target Rank**: Ranking by efficiency only (lower = better)\n- **Off-Target Rank**: Ranking by specificity only (lower = better)\n- **PAM Sequence**: The PAM sequence (e.g., \"AGG\", \"TGG\")\n\n**Knockout-specific columns:**\n- **sgRNA Cut Position (1-based)**: Genomic coordinate of cut site\n- **Exon Number**: Which exon is targeted\n- **Target Cut %**: Percentage of protein affected\n\n**Activation/Inhibition-specific columns:**\n- **sgRNA 'Cut' Position**: Position relative to gene\n- **sgRNA 'Cut' Site TSS Offset**: Distance from transcription start site (bp)\n- **DHS Score**: DNase hypersensitivity score (for CRISPRa)\n\n### 2.5 Extract and Select sgRNAs\n\n#### Step 1: Load Data and Filter for Your Gene\n\n```python\nimport pandas as pd\n\n# Load the dataset\ndf = pd.read_csv('sgRNA_design_9606_GRCh38_SpyoCas9_CRISPRko_*.txt',\n                 sep='\\t', low_memory=False)\n\n# Filter for your gene\ngene_name = \"TP53\"\ngene_sgrnas = df[df['Target Gene Symbol'] == gene_name].copy()\n\nprint(f\"Found {len(gene_sgrnas)} sgRNAs for {gene_name}\")\n```\n\n#### Step 2: Select Top sgRNAs\n\n**Default: Use Combined Rank (balances efficiency and specificity)**\n```python\n# Sort by Combined Rank (lower is better)\ntop_sgrnas = gene_sgrnas.nsmallest(10, 'Combined Rank')\n\nprint(top_sgrnas[['sgRNA Sequence', 'Combined Rank',\n                   'Exon Number', 'sgRNA Cut Position (1-based)']])\n```\n\n**Option A: Prioritize On-Target Efficiency**\n```python\n# Sort by On-Target Rank (for maximum cutting efficiency)\nefficient_sgrnas = gene_sgrnas.nsmallest(10, 'On-Target Rank')\n```\n\n**Option B: Prioritize Off-Target Specificity**\n```python\n# Sort by Off-Target Rank (for maximum specificity)\nspecific_sgrnas = gene_sgrnas.nsmallest(10, 'Off-Target Rank')\n```\n\n#### Step 3: Filter by Custom Criteria (Optional)\n\n**Filter by Exon Number:**\n```python\n# Target specific exon (e.g., exon 5)\nexon5_sgrnas = gene_sgrnas[gene_sgrnas['Exon Number'] == 5]\ntop_exon5 = exon5_sgrnas.nsmallest(5, 'Combined Rank')\n```\n\n**Filter by Genomic Position:**\n```python\n# Target specific genomic range\nposition_filtered = gene_sgrnas[\n    (gene_sgrnas['sgRNA Cut Position (1-based)'] >= 7572000) &\n    (gene_sgrnas['sgRNA Cut Position (1-based)'] <= 7575000)\n]\n```\n\n**Target Early Exons for Knockout:**\n```python\n# Get sgRNAs from first 3 exons\nearly_exons = gene_sgrnas[gene_sgrnas['Exon Number'] <= 3]\ntop_early = early_exons.nsmallest(10, 'Combined Rank')\n```\n\n**Filter by Target Cut Percentage:**\n```python\n# Target sgRNAs that affect significant portion of protein\nhigh_impact = gene_sgrnas[gene_sgrnas['Target Cut %'] <= 50]  # Cut in first 50%\ntop_high_impact = high_impact.nsmallest(10, 'Combined Rank')\n```\n\n#### Step 4: Select Multiple sgRNAs for Validation\n\n```python\n# Get top 4 sgRNAs from different exons for redundancy\nfinal_selection = gene_sgrnas.sort_values('Combined Rank').groupby('Exon Number').head(1).head(4)\n\n# Save results\nfinal_selection.to_csv(f'{gene_name}_selected_sgRNAs.csv', index=False)\n\nprint(\"\\nSelected sgRNAs:\")\nprint(final_selection[['sgRNA Sequence', 'Exon Number', 'Combined Rank']])\n```\n\n### 2.6 What to Do with Results\n\n‚úÖ **Once you have selected sgRNAs:**\n1. Choose **3-4 sgRNAs** (use Combined_Rank by default)\n\n‚ùå **If dataset doesn't cover your gene or organism:**\nProceed to **Option 3: De Novo sgRNA Design**\n\n\n## Option 3: General sgRNA Design Guidelines (Last Resort)\n\n### When to Use This Option?\n- Gene not covered in CRISPick datasets\n- Non-model organism\n- Custom design requirements\n\n### General Design Rules\n\n#### Essential Requirements:\n1. **Length**:\n   - 20 bp for SpCas9 and SaCas9\n   - 23-25 bp for Cas12a variants (AsCas12a, enAsCas12a)\n2. **PAM sequence**:\n   - **SpCas9**: Requires **NGG** immediately after target (3' end)\n   - **SaCas9**: Requires **NNGRRT** immediately after target (3' end)\n   - **AsCas12a** (wild-type): Requires **TTTV** before target (5' end)\n   - **enAsCas12a** (enhanced): Requires **TTTV** before target (5' end)\n   - **CRITICAL**: Guides designed for enAsCas12a may not work with wild-type AsCas12a due to different activity profiles\n3. **GC content**: 40-60% is optimal\n4. **Avoid**:\n   - TTTT sequences (terminates transcription)\n   - Long runs of same nucleotide (>4 repeats)\n\n#### Target Location:\n- **For knockout**: Target early exons (first 50% of gene)\n- **For activation**: Target -200 to +1 bp from transcription start site (TSS)\n- **For inhibition**: Target -50 to +300 bp from TSS\n\n#### Best Practices:\n- **Test 3-4 different sgRNAs** per target gene\n- Select sgRNAs with high efficiency scores (>0.5) and minimal off-targets\n- Validate experimentally with Sanger sequencing\n\n\n## Quick Start Examples\n\n### Example 1: Knockout TP53 in Human Cells\n\n**Step 1**: Check Addgene\n```python\ndf = pd.read_csv('addgene_grna_sequences.csv')\ntp53_results = df[(df['Target_Gene'] == 'TP53') &\n                  (df['Target_Species'] == 'H. sapiens') &\n                  (df['Application'] == 'cut')]\n# Result: Found 0 entries ‚Üí Proceed to Option 2\n```\n\n**Step 2**: Download CRISPick dataset\n```bash\n# Download human GRCh38 SpCas9 knockout dataset\nwget https://portals.broadinstitute.org/gppx/public/sgrna_design/api/downloads/\\\nsgRNA_design_9606_GRCh38_SpyoCas9_CRISPRko_RS3seq-Chen2013+RS3target_NCBI_20241104.txt.gz\n\ngunzip sgRNA_design_9606_GRCh38_SpyoCas9_CRISPRko_*.txt.gz\n```\n\n**Step 3**: Extract TP53 sgRNAs\n```python\ndf = pd.read_csv('sgRNA_design_9606_GRCh38_SpyoCas9_CRISPRko_*.txt', sep='\\t')\ntp53 = df[df['Gene_Symbol'] == 'TP53']\ntop_sgrnas = tp53[\n    (tp53['sgRNA_score'] > 0.6) &\n    (tp53['Off_target_stringency'] > 0.5)\n].sort_values('sgRNA_score', ascending=False).head(4)\n\nprint(top_sgrnas[['sgRNA_sequence', 'sgRNA_score', 'Exon_ID']])\n```\n\n### Example 2: Activate OCT4 in Human iPSCs\n\n**Step 1**: Check Addgene\n```python\noct4_results = df[(df['Target_Gene'] == 'OCT4') &\n                  (df['Application'] == 'activate')]\n# Found 1 validated sgRNA!\nprint(oct4_results['Target_Sequence'].values[0])\n# Use this sequence ‚úÖ\n```\n\n\n**Remember**: Always start with validated sequences (Option 1), then move to pre-computed designs (Option 2), and only use de novo design (Option 3) when necessary. Testing 3-4 sgRNAs per gene is standard practice regardless of prediction scores.\n\nüìö Single Cell RNA-seq Cell Type Annotation:\n# Single Cell RNA-seq Cell Type Annotation\n\n\n## Overview\n\nCell type annotation is the process of assigning cell type labels to clusters or individual cells in single-cell RNA-seq data. This guide covers three main approaches and their practical implementation.\n\n## Three Annotation Approaches\n\n### 1. Manual Marker-Based Annotation\nIdentify cell types by examining expression of known marker genes in each cluster.\n\n**Tools**: Scanpy, Seurat\n**Best for**: Small datasets, novel cell types, high confidence needs\n\n### 2. Automated Annotation\nUse pre-trained classifiers to automatically assign cell type labels.\n\n**Tools**: CellTypist, scAnnotate\n**Best for**: Standard tissues, quick preliminary annotation, large datasets\n\n### 3. Reference-Based Label Transfer\nTransfer labels from annotated reference datasets to your query data.\n\n**Tools**: scArches, scANVI, Azimuth, SingleR\n**Best for**: Well-characterized tissues, integration with public data\n\n## Recommended Workflow\n\n### Step 1: Quality Control First\n- **Remove low-quality cells before annotation**\n- Filter doublets (expected doublet rate: 0.8% per 1000 cells)\n- Check for ambient RNA contamination\n- Verify cluster quality and resolution\n\n### Step 2: Initial Marker-Based Assessment\n\n```python\n# Scanpy example\nimport scanpy as sc\n\n# Calculate marker genes for clusters\nsc.tl.rank_genes_groups(adata, 'leiden', method='wilcoxon')\n\n# Visualize top markers\nsc.pl.rank_genes_groups(adata, n_genes=25, sharey=False)\n\n# Plot known markers\nmarkers = {\n    'T cells': ['CD3D', 'CD3E', 'CD4', 'CD8A'],\n    'B cells': ['CD19', 'MS4A1', 'CD79A'],\n    'Monocytes': ['CD14', 'FCGR3A', 'LYZ'],\n    'NK cells': ['NCAM1', 'NKG7', 'GNLY']\n}\n\nsc.pl.dotplot(adata, markers, groupby='leiden')\n```\n\n### Step 3: Use Automated Tools for Validation\n\n```python\n# CellTypist example (fast, accurate for immune cells)\nimport celltypist\nfrom celltypist import models\n\n# Download immune cell model\nmodel = models.Model.load(model='Immune_All_Low.pkl')\n\n# Predict cell types\npredictions = celltypist.annotate(adata, model=model, majority_voting=True)\nadata = predictions.to_adata()\n```\n\n### Step 4: Reference-Based Refinement\n\n```python\n# scArches example for label transfer\nimport scarches as sca\n\n# Load pre-trained reference model\nmodel = sca.models.SCANVI.load_query_data(\n    adata=adata,  # Your query data\n    reference_model=\"path/to/reference_model\"\n)\n\n# Transfer labels\nmodel.train(max_epochs=100)\nadata.obs['transferred_labels'] = model.predict()\n```\n\n## Best Practices\n\n### Do's:\n1. **Always combine multiple approaches** - Use marker-based validation even with automated tools\n2. **Check cluster purity** - Ensure clusters represent single cell types\n3. **Validate with multiple marker sets** - Don't rely on single markers\n4. **Consider biological context** - Tissue type, disease state, developmental stage\n5. **Document confidence levels** - Note uncertain annotations\n6. **Use hierarchical annotation** - Broad categories first, then subtypes\n\n### Don'ts:\n1. **Don't over-cluster** - Too fine resolution creates artificial distinctions\n2. **Don't ignore batch effects** - Correct before annotation\n3. **Don't trust automation blindly** - Always validate predictions\n4. **Don't mix cell states with cell types** - Activated vs. resting cells are states, not types\n5. **Don't annotate low-quality cells** - Remove them first\n\n## Common Pitfalls\n\n### 1. Doublet Clusters\n**Problem**: Clusters with markers from multiple cell types\n**Solution**: Use doublet detection tools (Scrublet, DoubletFinder) before annotation\n\n### 2. Ambient RNA\n**Problem**: Background markers in all cells\n**Solution**: Use SoupX or CellBender for decontamination\n\n### 3. Over-interpretation of Small Clusters\n**Problem**: Rare clusters may be technical artifacts\n**Solution**: Require minimum cell count (e.g., >25 cells), validate with independent data\n\n### 4. Reference Mismatch\n**Problem**: Reference from different tissue/species/condition\n**Solution**: Use tissue-matched references, check marker overlap before transfer\n\n## Tool Selection Guide\n\n| Scenario | Recommended Tool | Why |\n|----------|------------------|-----|\n| Immune cells (human) | CellTypist | Pre-trained on large immune atlases |\n| Mouse tissues | scArches + Mouse Cell Atlas | Comprehensive mouse reference |\n| Novel cell types | Manual + Scanpy/Seurat | Need domain expertise |\n| Large datasets (>100k cells) | CellTypist | Fast, scalable |\n| Cross-species | Manual markers | Limited reference transfer |\n| Developmental data | scArches | Handles continuous states |\n\n## Key Marker Genes by Cell Type\n\n### Blood/Immune:\n- **T cells**: CD3D, CD3E (all T cells); CD4, CD8A (subtypes)\n- **B cells**: CD19, MS4A1 (CD20), CD79A\n- **Monocytes/Macrophages**: CD14, CD68, LYZ\n- **NK cells**: NCAM1 (CD56), NKG7, KLRD1\n- **Dendritic cells**: FCER1A, CD1C\n\n### Epithelial:\n- **General epithelial**: EPCAM, KRT18, KRT19\n- **Lung AT1**: AGER, PDPN\n- **Lung AT2**: SFTPC, SFTPA1\n- **Intestinal**: VIL1, MUC2\n\n### Stromal:\n- **Fibroblasts**: COL1A1, DCN, LUM\n- **Endothelial**: PECAM1 (CD31), VWF, CDH5\n- **Smooth muscle**: ACTA2, MYH11, TAGLN\n\n## Validation Checklist\n\n- [ ] Cluster purity: >80% cells with same label per cluster\n- [ ] Marker consistency: Top DE genes match expected markers\n- [ ] Biological plausibility: Expected proportions for tissue type\n- [ ] Cross-method agreement: Manual and automated annotations align\n- [ ] Reference quality: >70% cells successfully transferred\n- [ ] Doublet check: No clusters with multi-lineage markers\n- [ ] Documentation: Record confidence levels and uncertain calls\n\n## Resources\n\n### Tools:\n- **Scanpy**: https://scanpy.readthedocs.io/\n- **CellTypist**: https://www.celltypist.org/\n- **scArches**: https://scarches.readthedocs.io/\n- **Seurat**: https://satijalab.org/seurat/\n\n### References:\n- **PanglaoDB**: Database of marker genes\n- **CellMarker**: Curated cell marker database\n- **Human Cell Atlas**: Reference datasets\n\n### Pre-trained Models:\n- **CellTypist models**: 30+ tissue-specific models\n- **Azimuth references**: PBMC, lung, kidney, etc.\n- **scArches models**: Multiple tissue references\n\n## Troubleshooting\n\n**Issue**: All clusters look similar\n‚Üí Increase clustering resolution, check if data is normalized\n\n**Issue**: Too many small clusters\n‚Üí Decrease resolution, merge similar clusters based on markers\n\n**Issue**: Automated tool gives inconsistent results\n‚Üí Check input normalization, try multiple tools, fall back to manual\n\n**Issue**: Can't find clear markers for cluster\n‚Üí May be transitional state, doublet, or low-quality cells\n\n**Issue**: Reference transfer fails\n‚Üí Check batch correction, ensure overlapping gene sets, verify tissue match\n\nIMPORTANT: These documents are ALREADY AVAILABLE in your context. You do NOT need to\nretrieve them or \"review\" them as a separate step. You can DIRECTLY reference and use\nthe information from these documents to answer questions, provide protocols, suggest\nparameters, and offer troubleshooting guidance.\n\nThese documents contain expert knowledge, protocols, and troubleshooting guidance.\nReference them directly for experimental design, methodology, and problem-solving.\n\n===============================\n\n\nEnvironment Resources:\n\n- Function Dictionary:\nBased on your query, I've identified the following most relevant functions that you can use in your code:\n---\nImport file: biomni.tool.literature\n===================================\nMethod: fetch_supplementary_info_from_doi\n  Description: Fetches supplementary information for a paper given its DOI and saves it to a specified directory.\n  Required Parameters:\n    - doi (str): The paper DOI [Default: None]\n  Optional Parameters:\n    - output_dir (str): Directory to save supplementary files [Default: supplementary_info]\n\nMethod: query_arxiv\n  Description: Query arXiv for papers based on the provided search query.\n  Required Parameters:\n    - query (str): The search query string. [Default: None]\n  Optional Parameters:\n    - max_papers (int): The maximum number of papers to retrieve. [Default: 10]\n\nMethod: query_scholar\n  Description: Query Google Scholar for papers based on the provided search query and return the first search result.\n  Required Parameters:\n    - query (str): The search query string. [Default: None]\n\nMethod: query_pubmed\n  Description: Query PubMed for papers based on the provided search query.\n  Required Parameters:\n    - query (str): The search query string. [Default: None]\n  Optional Parameters:\n    - max_papers (int): The maximum number of papers to retrieve. [Default: 10]\n    - max_retries (int): Maximum number of retry attempts with modified queries. [Default: 3]\n\nMethod: search_google\n  Description: Search using Google search and return formatted results.\n  Required Parameters:\n    - query (str): The search query (e.g., \"protocol text or search question\") [Default: None]\n  Optional Parameters:\n    - num_results (int): Number of results to return [Default: 3]\n    - language (str): Language code for search results [Default: en]\n\nMethod: extract_url_content\n  Description: Extract the text content of a webpage using requests and BeautifulSoup.\n  Required Parameters:\n    - url (str): Webpage URL to extract content from [Default: None]\n\nMethod: extract_pdf_content\n  Description: Extract text content from a PDF file.\n  Required Parameters:\n    - url (str): URL of the PDF file [Default: None]\n\nMethod: advanced_web_search_claude\n  Description: Initiate an advanced web search by launching a specialized agent to collect relevant information and citations through multiple rounds of web searches for a given query.\n  Required Parameters:\n    - query (str): The search query string. [Default: None]\n  Optional Parameters:\n    - max_searches (int): Maximum number of searches [Default: 1]\n    - max_retries (int): Maximum number of retry attempts with modified queries. [Default: 3]\n\n\nImport file: biomni.tool.bioengineering\n=======================================\nMethod: perform_crispr_cas9_genome_editing\n  Description: Simulates CRISPR-Cas9 genome editing process including guide RNA design, delivery, and analysis.\n  Required Parameters:\n    - guide_rna_sequences (List[str]): List of guide RNA sequences (20 nucleotides each) targeting the genomic region of interest [Default: None]\n    - target_genomic_loci (str): Target genomic sequence to be edited (should be longer than guide RNA and contain the target sites) [Default: None]\n    - cell_tissue_type (str): Type of cell or tissue being edited (affects delivery efficiency and editing outcomes) [Default: None]\n\n\nImport file: biomni.tool.cell_biology\n=====================================\nMethod: perform_facs_cell_sorting\n  Description: Performs Fluorescence-Activated Cell Sorting (FACS) to enrich cell populations based on fluorescence characteristics.\n  Required Parameters:\n    - cell_suspension_data (str): Path to the FCS file containing flow cytometry data [Default: None]\n    - fluorescence_parameter (str): The fluorescence parameter to use for sorting (e.g., 'GFP', 'FITC', 'PE') [Default: None]\n  Optional Parameters:\n    - threshold_min (float): Minimum threshold for the fluorescence parameter. Cells below this value will be excluded [Default: None]\n    - threshold_max (float): Maximum threshold for the fluorescence parameter. Cells above this value will be excluded [Default: None]\n    - output_file (str): Filename to save the sorted cell population data [Default: sorted_cells.csv]\n\nMethod: analyze_flow_cytometry_immunophenotyping\n  Description: Analyze flow cytometry data to identify and quantify specific cell populations based on surface markers.\n  Required Parameters:\n    - fcs_file_path (str): Path to the FCS file containing flow cytometry data [Default: None]\n    - gating_strategy (dict): Dictionary defining the gating strategy. Each key is a population name, and each value is a list of tuples (marker, operator, threshold) [Default: None]\n  Optional Parameters:\n    - compensation_matrix (numpy.ndarray): Spillover/compensation matrix to correct for fluorescence overlap [Default: None]\n    - output_dir (str): Directory to save the results [Default: ./results]\n\n\nImport file: biomni.tool.molecular_biology\n==========================================\nMethod: get_gene_coding_sequence\n  Description: Retrieves the coding sequence(s) of a specified gene from NCBI Entrez.\n  Required Parameters:\n    - gene_name (str): Name of the gene [Default: None]\n    - organism (str): Name of the organism [Default: None]\n  Optional Parameters:\n    - email (str): Email address for NCBI Entrez (recommended) [Default: None]\n\nMethod: get_plasmid_sequence\n  Description: Unified function to retrieve plasmid sequences from either Addgene or NCBI. If is_addgene is True or identifier is numeric, uses Addgene. Otherwise searches NCBI using the plasmid name.\n  Required Parameters:\n    - identifier (str): Either an Addgene ID or plasmid name [Default: None]\n  Optional Parameters:\n    - is_addgene (bool): Force Addgene lookup if True, force NCBI if False. If None, attempts to auto-detect based on identifier format. [Default: None]\n\nMethod: align_sequences\n  Description: Align short sequences (primers) to a longer sequence, allowing for one mismatch. Checks both forward and reverse complement strands.\n  Required Parameters:\n    - long_seq (str): Target DNA sequence [Default: None]\n    - short_seqs (Union[str, List[str]]): Single primer or list of primers [Default: None]\n\nMethod: pcr_simple\n  Description: Simulate PCR amplification with given primers and sequence.\n  Required Parameters:\n    - sequence (str): Either a sequence string or path to plasmid file [Default: None]\n    - forward_primer (str): Forward primer sequence (5' to 3') [Default: None]\n    - reverse_primer (str): Reverse primer sequence (5' to 3') [Default: None]\n  Optional Parameters:\n    - circular (bool): Whether the sequence is circular [Default: False]\n\nMethod: digest_sequence\n  Description: Simulates restriction enzyme digestion of a DNA sequence and returns the resulting fragments with their properties.\n  Required Parameters:\n    - dna_sequence (str): Input DNA sequence to be digested [Default: None]\n    - enzyme_names (List[str]): Names of restriction enzymes to use for digestion [Default: None]\n  Optional Parameters:\n    - is_circular (bool): Whether the DNA sequence is circular (True) or linear (False) [Default: True]\n\nMethod: find_restriction_sites\n  Description: Identifies restriction enzyme sites in a given DNA sequence for specified enzymes.\n  Required Parameters:\n    - dna_sequence (str): Complete input DNA sequence [Default: None]\n    - enzymes (List[str]): List of restriction enzyme names to check [Default: None]\n  Optional Parameters:\n    - is_circular (bool): Whether the DNA sequence is circular (True) or linear (False) [Default: True]\n\nMethod: find_restriction_enzymes\n  Description: Finds common restriction enzyme sites in a DNA sequence and returns their cut positions.\n  Required Parameters:\n    - sequence (str): DNA sequence to analyze [Default: None]\n  Optional Parameters:\n    - is_circular (bool): Whether the sequence is circular [Default: False]\n\nMethod: find_sequence_mutations\n  Description: Compare query sequence against reference sequence to identify mutations.\n  Required Parameters:\n    - query_sequence (str): The sequence being analyzed [Default: None]\n    - reference_sequence (str): The reference sequence to compare against [Default: None]\n  Optional Parameters:\n    - query_start (int): The start position of the query sequence [Default: 1]\n\nMethod: design_knockout_sgrna\n  Description: Design sgRNAs for CRISPR knockout by searching pre-computed sgRNA libraries. Returns optimized guide RNAs for targeting a specific gene.\n  Required Parameters:\n    - gene_name (str): Target gene symbol/name (e.g., \"EGFR\", \"TP53\") [Default: None]\n    - data_lake_path (str): Path to the data lake [Default: None]\n  Optional Parameters:\n    - species (str): Target organism species [Default: human]\n    - num_guides (int): Number of guides to return [Default: 1]\n\nMethod: get_oligo_annealing_protocol\n  Description: Return a standard protocol for annealing oligonucleotides without phosphorylation.\n\nMethod: get_golden_gate_assembly_protocol\n  Description: Return a customized protocol for Golden Gate assembly based on the number of inserts and specific DNA sequences.\n  Required Parameters:\n    - enzyme_name (str): Type IIS restriction enzyme to be used [Default: None]\n    - vector_length (int): Length of the destination vector in bp [Default: None]\n  Optional Parameters:\n    - num_inserts (int): Number of inserts to be assembled [Default: 1]\n    - vector_amount_ng (float): Amount of vector to use in ng [Default: 75.0]\n    - insert_lengths (List[int]): List of insert lengths in bp [Default: None]\n    - is_library_prep (bool): Whether this is for library preparation [Default: False]\n\nMethod: get_bacterial_transformation_protocol\n  Description: Return a standard protocol for bacterial transformation.\n  Optional Parameters:\n    - antibiotic (str): Selection antibiotic [Default: ampicillin]\n    - is_repetitive (bool): Whether the sequence contains repetitive elements [Default: False]\n\nMethod: design_primer\n  Description: Design a single primer within the given sequence window.\n  Required Parameters:\n    - sequence (str): Target DNA sequence [Default: None]\n    - start_pos (int): Starting position for primer search [Default: None]\n  Optional Parameters:\n    - primer_length (int): Length of the primer to design [Default: 20]\n    - min_gc (float): Minimum GC content [Default: 0.4]\n    - max_gc (float): Maximum GC content [Default: 0.6]\n    - min_tm (float): Minimum melting temperature in ¬∞C [Default: 55.0]\n    - max_tm (float): Maximum melting temperature in ¬∞C [Default: 65.0]\n    - search_window (int): Size of window to search for primers [Default: 100]\n\nMethod: design_verification_primers\n  Description: Design Sanger sequencing primers to verify a specific region in a plasmid. First tries to use primers from an existing primer pool. If they cannot fully cover the region, designs additional primers as needed.\n  Required Parameters:\n    - plasmid_sequence (str): The complete plasmid sequence [Default: None]\n    - target_region (Tuple[int, int]): Start and end positions to verify (0-based indexing) [Default: None]\n  Optional Parameters:\n    - existing_primers (Optional[List[Dict[str, str]]]): List of existing primers with their sequences and optional names [Default: None]\n    - is_circular (bool): Whether the plasmid is circular [Default: True]\n    - coverage_length (int): Typical read length for each primer in base pairs [Default: 800]\n    - primer_length (int): Length of newly designed primers [Default: 20]\n    - min_gc (float): Minimum GC content for new primers [Default: 0.4]\n    - max_gc (float): Maximum GC content for new primers [Default: 0.6]\n    - min_tm (float): Minimum melting temperature in ¬∞C [Default: 55.0]\n    - max_tm (float): Maximum melting temperature in ¬∞C [Default: 65.0]\n\nMethod: design_golden_gate_oligos\n  Description: Design complementary oligonucleotides with Type IIS restriction enzyme overhangs for Golden Gate assembly based on restriction site analysis of the backbone.\n  Required Parameters:\n    - backbone_sequence (str): Complete backbone sequence [Default: None]\n    - insert_sequence (str): Sequence to be inserted (e.g., sgRNA target sequence) [Default: None]\n    - enzyme_name (str): Type IIS restriction enzyme to be used [Default: None]\n  Optional Parameters:\n    - is_circular (bool): Whether the backbone is circular [Default: True]\n\nMethod: golden_gate_assembly\n  Description: Simulate Golden Gate assembly to predict final construct sequences from backbone and fragment sequences.\n  Required Parameters:\n    - backbone_sequence (str): Complete backbone sequence [Default: None]\n    - enzyme_name (str): Type IIS restriction enzyme to be used (e.g., \"BsmBI\", \"BsaI\") [Default: None]\n    - fragments (List[Dict[str, str]]): List of fragments to insert, containing one of: name + fwd_oligo + rev_oligo (oligo pair with matching overhangs) or name + sequence (double-stranded DNA fragment containing restriction sites) [Default: None]\n  Optional Parameters:\n    - is_circular (bool): Whether the backbone is circular [Default: True]\n\n\nImport file: biomni.tool.genomics\n=================================\nMethod: get_rna_seq_archs4\n  Description: Given a gene name, fetch RNA-seq expression data showing the top K tissues with highest transcripts-per-million (TPM) values.\n  Required Parameters:\n    - gene_name (str): The gene name for which RNA-seq data is being fetched [Default: None]\n  Optional Parameters:\n    - K (int): The number of tissues to return [Default: 10]\n\nMethod: get_gene_set_enrichment_analysis_supported_database_list\n  Description: Returns a list of supported databases for gene set enrichment analysis.\n\nMethod: gene_set_enrichment_analysis\n  Description: Perform enrichment analysis for a list of genes, with optional background gene set and plotting functionality.\n  Required Parameters:\n    - genes (list): List of gene symbols to analyze [Default: None]\n  Optional Parameters:\n    - top_k (int): Number of top pathways to return [Default: 10]\n    - database (str): Database to use for enrichment analysis (e.g., pathway, transcription, ontology) [Default: ontology]\n    - background_list (list): List of background genes to use for enrichment analysis [Default: None]\n    - plot (bool): Generate a bar plot of the top K enrichment results [Default: False]\n\n\nImport file: biomni.tool.immunology\n===================================\nMethod: isolate_purify_immune_cells\n  Description: Simulates the isolation and purification of immune cells from tissue samples.\n  Required Parameters:\n    - tissue_type (str): The type of tissue sample (e.g., 'adipose', 'kidney', 'liver', 'lung', 'spleen') [Default: None]\n    - target_cell_type (str): The immune cell population to isolate (e.g., 'macrophages', 'leukocytes', 'T cells') [Default: None]\n  Optional Parameters:\n    - enzyme_type (str): The enzyme used for tissue digestion [Default: collagenase]\n    - macs_antibody (str): Specific antibody for magnetic-assisted cell sorting [Default: None]\n    - digestion_time_min (int): Digestion time in minutes [Default: 45]\n\nMethod: analyze_cfse_cell_proliferation\n  Description: Analyze CFSE-labeled cell samples to quantify cell division and proliferation.\n  Required Parameters:\n    - fcs_file_path (str): Path to the FCS file containing flow cytometry data from CFSE-labeled cells [Default: None]\n  Optional Parameters:\n    - cfse_channel (str): Name of the channel containing CFSE fluorescence data [Default: FL1-A]\n    - lymphocyte_gate (tuple or None): Tuple of (min_fsc, max_fsc, min_ssc, max_ssc) for lymphocyte gating [Default: None]\n\nMethod: analyze_cytokine_production_in_cd4_tcells\n  Description: Analyze cytokine production (IFN-Œ≥, IL-17) in CD4+ T cells after antigen stimulation.\n  Required Parameters:\n    - fcs_files_dict (dict): Dictionary mapping stimulation conditions to FCS file paths. Expected keys: 'unstimulated', 'Mtb300', 'CMV', 'SEB' [Default: None]\n  Optional Parameters:\n    - output_dir (str): Directory to save the results file [Default: ./results]\n\n\nImport file: biomni.tool.synthetic_biology\n==========================================\nMethod: analyze_barcode_sequencing_data\n  Description: Analyze sequencing data to extract, quantify and determine lineage relationships of barcodes.\n  Required Parameters:\n    - input_file (str): Path to the input sequencing file in FASTQ or FASTA format [Default: None]\n  Optional Parameters:\n    - barcode_pattern (str): Regular expression pattern to identify barcodes. If None, will use flanking sequences [Default: None]\n    - flanking_seq_5prime (str): 5' flanking sequence of the barcode region [Default: None]\n    - flanking_seq_3prime (str): 3' flanking sequence of the barcode region [Default: None]\n    - min_count (int): Minimum count threshold for considering a barcode [Default: 5]\n    - output_dir (str): Directory to save output files [Default: ./results]\n\n\nImport file: biomni.tool.database\n=================================\nMethod: query_uniprot\n  Description: Query the UniProt REST API using either natural language or a direct endpoint.\n  Required Parameters:\n    - prompt (str): Natural language query about proteins (e.g., \"Find information about human insulin\") [Default: None]\n  Optional Parameters:\n    - endpoint (str): Full or partial UniProt API endpoint URL to query directly (e.g., 'https://rest.uniprot.org/uniprotkb/P01308') [Default: None]\n    - max_results (int): Maximum number of results to return [Default: 5]\n\nMethod: query_kegg\n  Description: Take a natural language prompt and convert it to a structured KEGG API query.\n  Required Parameters:\n    - prompt (str): Natural language query about KEGG data [Default: None]\n  Optional Parameters:\n    - endpoint (str): Direct KEGG endpoint to query [Default: None]\n    - verbose (bool): Return detailed results [Default: True]\n\nMethod: query_stringdb\n  Description: Query the STRING protein interaction database using natural language or direct endpoint.\n  Required Parameters:\n    - prompt (str): Natural language query about protein interactions [Default: None]\n  Optional Parameters:\n    - endpoint (str): Full URL to query directly [Default: None]\n    - download_image (bool): Download image results if endpoint is image [Default: False]\n    - output_dir (str): Directory to save downloaded files [Default: None]\n    - verbose (bool): Return detailed results [Default: True]\n\nMethod: query_geo\n  Description: Query the NCBI GEO database (GDS/GEOPROFILES) using natural language or direct search term.\n  Required Parameters:\n    - prompt (str): Natural language query about expression data [Default: None]\n  Optional Parameters:\n    - search_term (str): Direct GEO search term [Default: None]\n    - max_results (int): Maximum number of results [Default: 3]\n\nMethod: query_ensembl\n  Description: Query the Ensembl REST API using natural language or a direct endpoint.\n  Required Parameters:\n    - prompt (str): Natural language query about genomic data [Default: None]\n  Optional Parameters:\n    - endpoint (str): Direct Ensembl endpoint or full URL [Default: None]\n    - verbose (bool): Return detailed results [Default: True]\n\nMethod: query_opentarget\n  Description: Query the OpenTargets Platform API using natural language or a direct GraphQL query.\n  Required Parameters:\n    - prompt (str): Natural language query about targets/diseases [Default: None]\n  Optional Parameters:\n    - query (str): Direct GraphQL query string [Default: None]\n    - variables (dict): Variables for GraphQL [Default: None]\n    - verbose (bool): Return detailed results [Default: False]\n\nMethod: query_reactome\n  Description: Query the Reactome database using natural language or a direct endpoint; optionally download pathway diagrams.\n  Required Parameters:\n    - prompt (str): Natural language query about biological pathways [Default: None]\n  Optional Parameters:\n    - endpoint (str): Direct endpoint or full URL [Default: None]\n    - download (bool): Download pathway diagram if available [Default: False]\n    - output_dir (str): Directory to save downloads [Default: None]\n    - verbose (bool): Return detailed results [Default: True]\n\nMethod: query_quickgo\n  Description: Query the QuickGO API using natural language or a direct endpoint.\n  Required Parameters:\n    - prompt (str): Natural language query about GO terms/annotations [Default: None]\n  Optional Parameters:\n    - endpoint (str): Direct QuickGO endpoint or full URL [Default: None]\n    - max_results (int): Max results (limit, up to 100) [Default: 25]\n    - verbose (bool): Return detailed results [Default: True]\n\nMethod: query_encode\n  Description: Query the ENCODE Portal API to locate functional genomics data (experiments, files, biosamples, datasets).\n  Required Parameters:\n    - prompt (str): Natural language query about functional genomics data [Default: None]\n  Optional Parameters:\n    - endpoint (str): Direct ENCODE Portal endpoint or full URL [Default: None]\n    - max_results (int|str): Limit for search endpoints (number or 'all') [Default: 25]\n    - verbose (bool): Return detailed results [Default: True]\n\n\nImport file: biomni.tool.protocols\n==================================\nMethod: search_protocols\n  Description: Search protocols.io for public protocols matching a keyword.\n  Required Parameters:\n    - query (str): Most important keyword or phrase to search (title, description, authors) [Default: None]\n\nMethod: get_protocol_details\n  Description: Retrieve detailed metadata for a specific protocols.io protocol by ID.\n  Required Parameters:\n    - protocol_id (int): Numeric protocol ID from protocols.io [Default: None]\n  Optional Parameters:\n    - timeout (int): Request timeout in seconds [Default: 30]\n\nMethod: list_local_protocols\n  Description: List available protocol files in the local biomni/tool/protocols/ directory. Includes protocols from Addgene and Thermo Fisher Scientific.\n  Optional Parameters:\n    - source (str): Filter by source directory (e.g., 'addgene' or 'thermofisher'). If None, lists all protocols. [Default: None]\n\nMethod: read_local_protocol\n  Description: Read the contents of a local protocol file from biomni/tool/protocols/. Use list_local_protocols() first to find available protocol filenames.\n  Required Parameters:\n    - filename (str): Name of the protocol file (e.g., 'Addgene_ Protocol - How to Run an Agarose Gel.txt') [Default: None]\n  Optional Parameters:\n    - source (str): Source directory (e.g., 'addgene' or 'thermofisher'). If None, searches all sources. [Default: None]\n\n\n---\n\nIMPORTANT: When using any function, you MUST first import it from its module. For example:\nfrom [module_name] import [function_name]\n\n- Biological data lake\nYou can access a biological data lake at the following path: /app/data/biomni_data/data_lake.\nBased on your query, I've identified the following most relevant datasets:\nEach item is listed with its description to help you understand its contents.\n----\ntwo-hybrid.parquet: Protein-protein interactions detected by yeast two-hybrid assays.\nMcPAS-TCR.parquet: T-cell receptor sequences and specificity data from McPAS database.\nDepMap_OmicsExpressionProteinCodingGenesTPMLogp1.csv: Gene expression in TPMs for cancer cell lines, including all DepMap models.\ngene_info.parquet: Comprehensive gene information.\nsynthetic_rescue.parquet: Genetic interactions rescuing phenotypes.\ngtex_tissue_gene_tpm.parquet: Gene expression (TPM) across human tissues from GTEx.\nmarker_celltype.parquet: Cell type marker genes for identification.\nproteinatlas.tsv: Protein expression data from Human Protein Atlas.\nDepMap_CRISPRGeneDependency.csv:\n  Gene dependency probability estimates for cancer cell lines, including all\n  DepMap models.\nsynthetic_growth_defect.parquet: Synthetic growth defects from genetic interactions.\nsgRNA_KO_SP_mouse.txt: sgRNA knockout data for mouse.\nco-fractionation.parquet: Protein-protein interactions from co-fractionation experiments.\nmsigdb_human_c5_ontology_geneset.parquet: Ontology-based gene sets from MSigDB.\nsynthetic_lethality.parquet: Synthetic lethal interactions.\nDisGeNET.parquet: Gene-disease associations from multiple sources.\nDepMap_CRISPRGeneEffect.csv:\n  Genome-wide CRISPR gene effect estimates for cancer cell lines, including all\n  DepMap models.\nsgRNA_KO_SP_human.txt: sgRNA knockout data for human.\nmsigdb_human_c7_immunologic_signature_geneset.parquet: Immunologic signatures from MSigDB.\nmsigdb_human_c2_curated_geneset.parquet: Curated human gene sets from MSigDB.\ngenetic_interaction.parquet: Genetic interactions between genes.\nproximity_label-ms.parquet: Protein interactions via proximity labeling and mass spectrometry.\ngo-plus.json: Gene ontology data for functional gene annotations.\nmsigdb_human_c6_oncogenic_signature_geneset.parquet: Oncogenic signatures from MSigDB.\nmsigdb_human_h_hallmark_geneset.parquet: Hallmark gene sets from MSigDB.\n----\n\n- Software Library:\nBased on your query, I've identified the following most relevant libraries that you can use:\nEach library is listed with its description to help you understand its functionality.\n----\nbiopython:\n  [Python Package] A set of tools for biological computation including parsers for\n  bioinformatics files, access to online services, and interfaces to common\n  bioinformatics programs.\nscanpy:\n  [Python Package] A scalable toolkit for analyzing single-cell gene expression\n  data, specifically designed for large datasets using AnnData.\nanndata:\n  [Python Package] A Python package for handling annotated data matrices in memory\n  and on disk, primarily used for single-cell genomics data.\ngget:\n  [Python Package] A toolkit for accessing genomic databases and retrieving\n  sequences, annotations, and other genomic data.\ngseapy:\n  [Python Package] A Python wrapper for Gene Set Enrichment Analysis (GSEA) and\n  visualization.\ncellxgene-census:\n  [Python Package] A tool for accessing and analyzing the CellxGene Census, a\n  collection of single-cell datasets. To download a dataset, use the\n  download_source_h5ad function with the dataset id as the argument\n  (856c1b98-5727-49da-bf0f-151bdb8cb056, no .h5ad extension).\npandas:\n  [Python Package] A fast, powerful, and flexible data analysis and manipulation\n  library for Python.\nnumpy:\n  [Python Package] The fundamental package for scientific computing with Python,\n  providing support for arrays, matrices, and mathematical functions.\nscipy:\n  [Python Package] A Python library for scientific and technical computing,\n  including modules for optimization, linear algebra, integration, and statistics.\nscikit-learn:\n  [Python Package] A machine learning library featuring various classification,\n  regression, and clustering algorithms.\nstatsmodels:\n  [Python Package] A Python module for statistical modeling and econometrics,\n  including descriptive statistics and estimation of statistical models.\nmageck: [Python Package] Analysis of CRISPR screen data.\nigraph: [Python Package] Network analysis and visualization.\nflowkit: [Python Package] Toolkit for processing flow cytometry data.\npysam:\n  [Python Package] A Python module for reading, manipulating and writing genomic\n  data sets in SAM/BAM/VCF/BCF formats.\nh5py:\n  [Python Package] A Python interface to the HDF5 binary data format, allowing\n  storage of large amounts of numerical data.\ntqdm: [Python Package] A fast, extensible progress bar for loops and CLI applications.\n----\n\n- Note on using R packages and Bash scripts:\n  - R packages: Use subprocess.run(['Rscript', '-e', 'your R code here']) in Python, or use the #!R marker in your execute block.\n  - Bash scripts and commands: Use the #!BASH marker in your execute block for both simple commands and complex shell scripts with variables, loops, conditionals, etc.\n        \n\nIMPORTANT FOR GPT MODELS: You MUST use XML tags <execute> or <solution> in EVERY response. Do not use markdown code blocks (```) - use <execute> tags instead.\n\nUse <think>...</think> tags to show your step-by-step reasoning process before acting.",
            "additional_kwargs": {},
            "response_metadata": {}
        },
        {
            "id": null,
            "name": null,
            "type": "human",
            "content": "Plan and experience a CRISPR screen to identify genes that regulate T cell exhaustion, measured by the change in T cell receptor (TCR) signaling between acute (interleukin-2 [IL-2] only) and chronic (anti-CD3 and IL-2) stimulation conditions. Generate 32 genes that maximize the perturbation effect.",
            "additional_kwargs": {},
            "response_metadata": {}
        },
        {
            "id": null,
            "name": null,
            "type": "ai",
            "content": "<think>\nObservation:\n{\"tools\": [{\"id\": 0, \"name\": \"fetch_supplementary_info_from_doi\", \"description\": \"Fetches supplementary information for a paper given its DOI and saves it to a specified directory.\", \"optional_parameters\": [{\"name\": \"output_dir\", \"type\": \"str\", \"default\": \"supplementary_info\", \"description\": \"Directory to save supplementary files\"}], \"required_parameters\": [{\"name\": \"doi\", \"type\": \"str\", \"default\": null, \"description\": \"The paper DOI\"}]}, {\"id\": 1, \"name\": \"query_arxiv\", \"description\": \"Query arXiv for papers based on the provided search query.\", \"optional_parameters\": [{\"name\": \"max_papers\", \"type\": \"int\", \"default\": 10, \"description\": \"The maximum number of papers to retrieve.\"}], \"required_parameters\": [{\"name\": \"query\", \"type\": \"str\", \"default\": null, \"description\": \"The search query string.\"}]}, {\"id\": 2, \"name\": \"query_scholar\", \"description\": \"Query Google Scholar for papers based on the provided search query and return the first search result.\", \"optional_parameters\": [], \"required_parameters\": [{\"name\": \"query\", \"type\": \"str\", \"default\": null, \"description\": \"The search query string.\"}]}, {\"id\": 3, \"name\": \"query_pubmed\", \"description\": \"Query PubMed for papers based on the provided search query.\", \"optional_parameters\": [{\"name\": \"max_papers\", \"type\": \"int\", \"default\": 10, \"description\": \"The maximum number of papers to retrieve.\"}, {\"name\": \"max_retries\", \"type\": \"int\", \"default\": 3, \"description\": \"Maximum number of retry attempts with modified queries.\"}], \"required_parameters\": [{\"name\": \"query\", \"type\": \"str\", \"default\": null, \"description\": \"The search query string.\"}]}, {\"id\": 4, \"name\": \"search_google\", \"description\": \"Search using Google search and return formatted results.\", \"optional_parameters\": [{\"name\": \"num_results\", \"type\": \"int\", \"default\": 3, \"description\": \"Number of results to return\"}, {\"name\": \"language\", \"type\": \"str\", \"default\": \"en\", \"description\": \"Language code for search results\"}], \"required_parameters\": [{\"name\": \"query\", \"type\": \"str\", \"default\": null, \"description\": \"The search query (e.g., \\\"protocol text or search question\\\")\"}]}, {\"id\": 5, \"name\": \"extract_url_content\", \"description\": \"Extract the text content of a webpage using requests and BeautifulSoup.\", \"optional_parameters\": [], \"required_parameters\": [{\"name\": \"url\", \"type\": \"str\", \"default\": null, \"description\": \"Webpage URL to extract content from\"}]}, {\"id\": 6, \"name\": \"extract_pdf_content\", \"description\": \"Extract text content from a PDF file.\", \"optional_parameters\": [], \"required_parameters\": [{\"name\": \"url\", \"type\": \"str\", \"default\": null, \"description\": \"URL of the PDF file\"}]}, {\"id\": 7, \"name\": \"advanced_web_search_claude\", \"description\": \"Initiate an advanced web search by launching a specialized agent to collect relevant information and citations through multiple rounds of web searches for a given query.\", \"optional_parameters\": [{\"name\": \"max_searches\", \"type\": \"int\", \"default\": 1, \"description\": \"Maximum number of searches\"}, {\"name\": \"max_retries\", \"type\": \"int\", \"default\": 3, \"description\": \"Maximum number of retry attempts with modified queries.\"}], \"required_parameters\": [{\"name\": \"query\", \"type\": \"str\", \"default\": null, \"description\": \"The search query string.\"}]}, {\"id\": 25, \"name\": \"perform_crispr_cas9_genome_editing\", \"description\": \"Simulates CRISPR-Cas9 genome editing process including guide RNA design, delivery, and analysis.\", \"optional_parameters\": [], \"required_parameters\": [{\"name\": \"guide_rna_sequences\", \"type\": \"List[str]\", \"default\": null, \"description\": \"List of guide RNA sequences (20 nucleotides each) targeting the genomic region of interest\"}, {\"name\": \"target_genomic_loci\", \"type\": \"str\", \"default\": null, \"description\": \"Target genomic sequence to be edited (should be longer than guide RNA and contain the target sites)\"}, {\"name\": \"cell_tissue_type\", \"type\": \"str\", \"default\": null, \"description\": \"Type of cell or tissue being edited (affects delivery efficiency and editing outcomes)\"}]}, {\"id\": 45, \"name\": \"perform_facs_cell_sorting\", \"description\": \"Performs Fluorescence-Activated Cell Sorting (FACS) to enrich cell populations based on fluorescence characteristics.\", \"optional_parameters\": [{\"name\": \"threshold_min\", \"type\": \"float\", \"default\": null, \"description\": \"Minimum threshold for the fluorescence parameter. Cells below this value will be excluded\"}, {\"name\": \"threshold_max\", \"type\": \"float\", \"default\": null, \"description\": \"Maximum threshold for the fluorescence parameter. Cells above this value will be excluded\"}, {\"name\": \"output_file\", \"type\": \"str\", \"default\": \"sorted_cells.csv\", \"description\": \"Filename to save the sorted cell population data\"}], \"required_parameters\": [{\"name\": \"cell_suspension_data\", \"type\": \"str\", \"default\": null, \"description\": \"Path to the FCS file containing flow cytometry data\"}, {\"name\": \"fluorescence_parameter\", \"type\": \"str\", \"default\": null, \"description\": \"The fluorescence parameter to use for sorting (e.g., 'GFP', 'FITC', 'PE')\"}]}, {\"id\": 46, \"name\": \"analyze_flow_cytometry_immunophenotyping\", \"description\": \"Analyze flow cytometry data to identify and quantify specific cell populations based on surface markers.\", \"optional_parameters\": [{\"name\": \"compensation_matrix\", \"type\": \"numpy.ndarray\", \"default\": null, \"description\": \"Spillover/compensation matrix to correct for fluorescence overlap\"}, {\"name\": \"output_dir\", \"type\": \"str\", \"default\": \"./results\", \"description\": \"Directory to save the results\"}], \"required_parameters\": [{\"name\": \"fcs_file_path\", \"type\": \"str\", \"default\": null, \"description\": \"Path to the FCS file containing flow cytometry data\"}, {\"name\": \"gating_strategy\", \"type\": \"dict\", \"default\": null, \"description\": \"Dictionary defining the gating strategy. Each key is a population name, and each value is a list of tuples (marker, operator, threshold)\"}]}, {\"id\": 50, \"name\": \"get_gene_coding_sequence\", \"description\": \"Retrieves the coding sequence(s) of a specified gene from NCBI Entrez.\", \"optional_parameters\": [{\"name\": \"email\", \"type\": \"str\", \"default\": null, \"description\": \"Email address for NCBI Entrez (recommended)\"}], \"required_parameters\": [{\"name\": \"gene_name\", \"type\": \"str\", \"default\": null, \"description\": \"Name of the gene\"}, {\"name\": \"organism\", \"type\": \"str\", \"default\": null, \"description\": \"Name of the organism\"}]}, {\"id\": 51, \"name\": \"get_plasmid_sequence\", \"description\": \"Unified function to retrieve plasmid sequences from either Addgene or NCBI. If is_addgene is True or identifier is numeric, uses Addgene. Otherwise searches NCBI using the plasmid name.\", \"optional_parameters\": [{\"name\": \"is_addgene\", \"type\": \"bool\", \"default\": null, \"description\": \"Force Addgene lookup if True, force NCBI if False. If None, attempts to auto-detect based on identifier format.\"}], \"required_parameters\": [{\"name\": \"identifier\", \"type\": \"str\", \"default\": null, \"description\": \"Either an Addgene ID or plasmid name\"}]}, {\"id\": 52, \"name\": \"align_sequences\", \"description\": \"Align short sequences (primers) to a longer sequence, allowing for one mismatch. Checks both forward and reverse complement strands.\", \"optional_parameters\": [], \"required_parameters\": [{\"name\": \"long_seq\", \"type\": \"str\", \"default\": null, \"description\": \"Target DNA sequence\"}, {\"name\": \"short_seqs\", \"type\": \"Union[str, List[str]]\", \"default\": null, \"description\": \"Single primer or list of primers\"}]}, {\"id\": 53, \"name\": \"pcr_simple\", \"description\": \"Simulate PCR amplification with given primers and sequence.\", \"optional_parameters\": [{\"name\": \"circular\", \"type\": \"bool\", \"default\": false, \"description\": \"Whether the sequence is circular\"}], \"required_parameters\": [{\"name\": \"sequence\", \"type\": \"str\", \"default\": null, \"description\": \"Either a sequence string or path to plasmid file\"}, {\"name\": \"forward_primer\", \"type\": \"str\", \"default\": null, \"description\": \"Forward primer sequence (5' to 3')\"}, {\"name\": \"reverse_primer\", \"type\": \"str\", \"default\": null, \"description\": \"Reverse primer sequence (5' to 3')\"}]}, {\"id\": 54, \"name\": \"digest_sequence\", \"description\": \"Simulates restriction enzyme digestion of a DNA sequence and returns the resulting fragments with their properties.\", \"optional_parameters\": [{\"name\": \"is_circular\", \"type\": \"bool\", \"default\": true, \"description\": \"Whether the DNA sequence is circular (True) or linear (False)\"}], \"required_parameters\": [{\"name\": \"dna_sequence\", \"type\": \"str\", \"default\": null, \"description\": \"Input DNA sequence to be digested\"}, {\"name\": \"enzyme_names\", \"type\": \"List[str]\", \"default\": null, \"description\": \"Names of restriction enzymes to use for digestion\"}]}, {\"id\": 55, \"name\": \"find_restriction_sites\", \"description\": \"Identifies restriction enzyme sites in a given DNA sequence for specified enzymes.\", \"optional_parameters\": [{\"name\": \"is_circular\", \"type\": \"bool\", \"default\": true, \"description\": \"Whether the DNA sequence is circular (True) or linear (False)\"}], \"required_parameters\": [{\"name\": \"dna_sequence\", \"type\": \"str\", \"default\": null, \"description\": \"Complete input DNA sequence\"}, {\"name\": \"enzymes\", \"type\": \"List[str]\", \"default\": null, \"description\": \"List of restriction enzyme names to check\"}]}, {\"id\": 56, \"name\": \"find_restriction_enzymes\", \"description\": \"Finds common restriction enzyme sites in a DNA sequence and returns their cut positions.\", \"optional_parameters\": [{\"name\": \"is_circular\", \"type\": \"bool\", \"default\": false, \"description\": \"Whether the sequence is circular\"}], \"required_parameters\": [{\"name\": \"sequence\", \"type\": \"str\", \"default\": null, \"description\": \"DNA sequence to analyze\"}]}, {\"id\": 57, \"name\": \"find_sequence_mutations\", \"description\": \"Compare query sequence against reference sequence to identify mutations.\", \"optional_parameters\": [{\"name\": \"query_start\", \"type\": \"int\", \"default\": 1, \"description\": \"The start position of the query sequence\"}], \"required_parameters\": [{\"name\": \"query_sequence\", \"type\": \"str\", \"default\": null, \"description\": \"The sequence being analyzed\"}, {\"name\": \"reference_sequence\", \"type\": \"str\", \"default\": null, \"description\": \"The reference sequence to compare against\"}]}, {\"id\": 58, \"name\": \"design_knockout_sgrna\", \"description\": \"Design sgRNAs for CRISPR knockout by searching pre-computed sgRNA libraries. Returns optimized guide RNAs for targeting a specific gene.\", \"optional_parameters\": [{\"name\": \"species\", \"type\": \"str\", \"default\": \"human\", \"description\": \"Target organism species\"}, {\"name\": \"num_guides\", \"type\": \"int\", \"default\": 1, \"description\": \"Number of guides to return\"}], \"required_parameters\": [{\"name\": \"gene_name\", \"type\": \"str\", \"default\": null, \"description\": \"Target gene symbol/name (e.g., \\\"EGFR\\\", \\\"TP53\\\")\"}, {\"name\": \"data_lake_path\", \"type\": \"str\", \"default\": null, \"description\": \"Path to the data lake\"}]}, {\"id\": 59, \"name\": \"get_oligo_annealing_protocol\", \"description\": \"Return a standard protocol for annealing oligonucleotides without phosphorylation.\", \"optional_parameters\": [], \"required_parameters\": []}, {\"id\": 60, \"name\": \"get_golden_gate_assembly_protocol\", \"description\": \"Return a customized protocol for Golden Gate assembly based on the number of inserts and specific DNA sequences.\", \"optional_parameters\": [{\"name\": \"num_inserts\", \"type\": \"int\", \"default\": 1, \"description\": \"Number of inserts to be assembled\"}, {\"name\": \"vector_amount_ng\", \"type\": \"float\", \"default\": 75, \"description\": \"Amount of vector to use in ng\"}, {\"name\": \"insert_lengths\", \"type\": \"List[int]\", \"default\": null, \"description\": \"List of insert lengths in bp\"}, {\"name\": \"is_library_prep\", \"type\": \"bool\", \"default\": false, \"description\": \"Whether this is for library preparation\"}], \"required_parameters\": [{\"name\": \"enzyme_name\", \"type\": \"str\", \"default\": null, \"description\": \"Type IIS restriction enzyme to be used\"}, {\"name\": \"vector_length\", \"type\": \"int\", \"default\": null, \"description\": \"Length of the destination vector in bp\"}]}, {\"id\": 61, \"name\": \"get_bacterial_transformation_protocol\", \"description\": \"Return a standard protocol for bacterial transformation.\", \"optional_parameters\": [{\"name\": \"antibiotic\", \"type\": \"str\", \"default\": \"ampicillin\", \"description\": \"Selection antibiotic\"}, {\"name\": \"is_repetitive\", \"type\": \"bool\", \"default\": false, \"description\": \"Whether the sequence contains repetitive elements\"}], \"required_parameters\": []}, {\"id\": 62, \"name\": \"design_primer\", \"description\": \"Design a single primer within the given sequence window.\", \"optional_parameters\": [{\"name\": \"primer_length\", \"type\": \"int\", \"default\": 20, \"description\": \"Length of the primer to design\"}, {\"name\": \"min_gc\", \"type\": \"float\", \"default\": 0.4, \"description\": \"Minimum GC content\"}, {\"name\": \"max_gc\", \"type\": \"float\", \"default\": 0.6, \"description\": \"Maximum GC content\"}, {\"name\": \"min_tm\", \"type\": \"float\", \"default\": 55, \"description\": \"Minimum melting temperature in ¬∞C\"}, {\"name\": \"max_tm\", \"type\": \"float\", \"default\": 65, \"description\": \"Maximum melting temperature in ¬∞C\"}, {\"name\": \"search_window\", \"type\": \"int\", \"default\": 100, \"description\": \"Size of window to search for primers\"}], \"required_parameters\": [{\"name\": \"sequence\", \"type\": \"str\", \"default\": null, \"description\": \"Target DNA sequence\"}, {\"name\": \"start_pos\", \"type\": \"int\", \"default\": null, \"description\": \"Starting position for primer search\"}]}, {\"id\": 63, \"name\": \"design_verification_primers\", \"description\": \"Design Sanger sequencing primers to verify a specific region in a plasmid. First tries to use primers from an existing primer pool. If they cannot fully cover the region, designs additional primers as needed.\", \"optional_parameters\": [{\"name\": \"existing_primers\", \"type\": \"Optional[List[Dict[str, str]]]\", \"default\": null, \"description\": \"List of existing primers with their sequences and optional names\"}, {\"name\": \"is_circular\", \"type\": \"bool\", \"default\": true, \"description\": \"Whether the plasmid is circular\"}, {\"name\": \"coverage_length\", \"type\": \"int\", \"default\": 800, \"description\": \"Typical read length for each primer in base pairs\"}, {\"name\": \"primer_length\", \"type\": \"int\", \"default\": 20, \"description\": \"Length of newly designed primers\"}, {\"name\": \"min_gc\", \"type\": \"float\", \"default\": 0.4, \"description\": \"Minimum GC content for new primers\"}, {\"name\": \"max_gc\", \"type\": \"float\", \"default\": 0.6, \"description\": \"Maximum GC content for new primers\"}, {\"name\": \"min_tm\", \"type\": \"float\", \"default\": 55, \"description\": \"Minimum melting temperature in ¬∞C\"}, {\"name\": \"max_tm\", \"type\": \"float\", \"default\": 65, \"description\": \"Maximum melting temperature in ¬∞C\"}], \"required_parameters\": [{\"name\": \"plasmid_sequence\", \"type\": \"str\", \"default\": null, \"description\": \"The complete plasmid sequence\"}, {\"name\": \"target_region\", \"type\": \"Tuple[int, int]\", \"default\": null, \"description\": \"Start and end positions to verify (0-based indexing)\"}]}, {\"id\": 64, \"name\": \"design_golden_gate_oligos\", \"description\": \"Design complementary oligonucleotides with Type IIS restriction enzyme overhangs for Golden Gate assembly based on restriction site analysis of the backbone.\", \"optional_parameters\": [{\"name\": \"is_circular\", \"type\": \"bool\", \"default\": true, \"description\": \"Whether the backbone is circular\"}], \"required_parameters\": [{\"name\": \"backbone_sequence\", \"type\": \"str\", \"default\": null, \"description\": \"Complete backbone sequence\"}, {\"name\": \"insert_sequence\", \"type\": \"str\", \"default\": null, \"description\": \"Sequence to be inserted (e.g., sgRNA target sequence)\"}, {\"name\": \"enzyme_name\", \"type\": \"str\", \"default\": null, \"description\": \"Type IIS restriction enzyme to be used\"}]}, {\"id\": 65, \"name\": \"golden_gate_assembly\", \"description\": \"Simulate Golden Gate assembly to predict final construct sequences from backbone and fragment sequences.\", \"optional_parameters\": [{\"name\": \"is_circular\", \"type\": \"bool\", \"default\": true, \"description\": \"Whether the backbone is circular\"}], \"required_parameters\": [{\"name\": \"backbone_sequence\", \"type\": \"str\", \"default\": null, \"description\": \"Complete backbone sequence\"}, {\"name\": \"enzyme_name\", \"type\": \"str\", \"default\": null, \"description\": \"Type IIS restriction enzyme to be used (e.g., \\\"BsmBI\\\", \\\"BsaI\\\")\"}, {\"name\": \"fragments\", \"type\": \"List[Dict[str, str]]\", \"default\": null, \"description\": \"List of fragments to insert, containing one of: name + fwd_oligo + rev_oligo (oligo pair with matching overhangs) or name + sequence (double-stranded DNA fragment containing restriction sites)\"}]}, {\"id\": 81, \"name\": \"get_rna_seq_archs4\", \"description\": \"Given a gene name, fetch RNA-seq expression data showing the top K tissues with highest transcripts-per-million (TPM) values.\", \"optional_parameters\": [{\"name\": \"K\", \"type\": \"int\", \"default\": 10, \"description\": \"The number of tissues to return\"}], \"required_parameters\": [{\"name\": \"gene_name\", \"type\": \"str\", \"default\": null, \"description\": \"The gene name for which RNA-seq data is being fetched\"}]}, {\"id\": 82, \"name\": \"get_gene_set_enrichment_analysis_supported_database_list\", \"description\": \"Returns a list of supported databases for gene set enrichment analysis.\", \"optional_parameters\": [], \"required_parameters\": []}, {\"id\": 83, \"name\": \"gene_set_enrichment_analysis\", \"description\": \"Perform enrichment analysis for a list of genes, with optional background gene set and plotting functionality.\", \"optional_parameters\": [{\"name\": \"top_k\", \"type\": \"int\", \"default\": 10, \"description\": \"Number of top pathways to return\"}, {\"name\": \"database\", \"type\": \"str\", \"default\": \"ontology\", \"description\": \"Database to use for enrichment analysis (e.g., pathway, transcription, ontology)\"}, {\"name\": \"background_list\", \"type\": \"list\", \"default\": null, \"description\": \"List of background genes to use for enrichment analysis\"}, {\"name\": \"plot\", \"type\": \"bool\", \"default\": false, \"description\": \"Generate a bar plot of the top K enrichment results\"}], \"required_parameters\": [{\"name\": \"genes\", \"type\": \"list\", \"default\": null, \"description\": \"List of gene symbols to analyze\"}]}, {\"id\": 96, \"name\": \"isolate_purify_immune_cells\", \"description\": \"Simulates the isolation and purification of immune cells from tissue samples.\", \"optional_parameters\": [{\"name\": \"enzyme_type\", \"type\": \"str\", \"default\": \"collagenase\", \"description\": \"The enzyme used for tissue digestion\"}, {\"name\": \"macs_antibody\", \"type\": \"str\", \"default\": null, \"description\": \"Specific antibody for magnetic-assisted cell sorting\"}, {\"name\": \"digestion_time_min\", \"type\": \"int\", \"default\": 45, \"description\": \"Digestion time in minutes\"}], \"required_parameters\": [{\"name\": \"tissue_type\", \"type\": \"str\", \"default\": null, \"description\": \"The type of tissue sample (e.g., 'adipose', 'kidney', 'liver', 'lung', 'spleen')\"}, {\"name\": \"target_cell_type\", \"type\": \"str\", \"default\": null, \"description\": \"The immune cell population to isolate (e.g., 'macrophages', 'leukocytes', 'T cells')\"}]}, {\"id\": 99, \"name\": \"analyze_cfse_cell_proliferation\", \"description\": \"Analyze CFSE-labeled cell samples to quantify cell division and proliferation.\", \"optional_parameters\": [{\"name\": \"cfse_channel\", \"type\": \"str\", \"default\": \"FL1-A\", \"description\": \"Name of the channel containing CFSE fluorescence data\"}, {\"name\": \"lymphocyte_gate\", \"type\": \"tuple or None\", \"default\": null, \"description\": \"Tuple of (min_fsc, max_fsc, min_ssc, max_ssc) for lymphocyte gating\"}], \"required_parameters\": [{\"name\": \"fcs_file_path\", \"type\": \"str\", \"default\": null, \"description\": \"Path to the FCS file containing flow cytometry data from CFSE-labeled cells\"}]}, {\"id\": 100, \"name\": \"analyze_cytokine_production_in_cd4_tcells\", \"description\": \"Analyze cytokine production (IFN-Œ≥, IL-17) in CD4+ T cells after antigen stimulation.\", \"optional_parameters\": [{\"name\": \"output_dir\", \"type\": \"str\", \"default\": \"./results\", \"description\": \"Directory to save the results file\"}], \"required_parameters\": [{\"name\": \"fcs_files_dict\", \"type\": \"dict\", \"default\": null, \"description\": \"Dictionary mapping stimulation conditions to FCS file paths. Expected keys: 'unstimulated', 'Mtb300', 'CMV', 'SEB'\"}]}, {\"id\": 161, \"name\": \"analyze_barcode_sequencing_data\", \"description\": \"Analyze sequencing data to extract, quantify and determine lineage relationships of barcodes.\", \"optional_parameters\": [{\"name\": \"barcode_pattern\", \"type\": \"str\", \"default\": null, \"description\": \"Regular expression pattern to identify barcodes. If None, will use flanking sequences\"}, {\"name\": \"flanking_seq_5prime\", \"type\": \"str\", \"default\": null, \"description\": \"5' flanking sequence of the barcode region\"}, {\"name\": \"flanking_seq_3prime\", \"type\": \"str\", \"default\": null, \"description\": \"3' flanking sequence of the barcode region\"}, {\"name\": \"min_count\", \"type\": \"int\", \"default\": 5, \"description\": \"Minimum count threshold for considering a barcode\"}, {\"name\": \"output_dir\", \"type\": \"str\", \"default\": \"./results\", \"description\": \"Directory to save output files\"}], \"required_parameters\": [{\"name\": \"input_file\", \"type\": \"str\", \"default\": null, \"description\": \"Path to the input sequencing file in FASTQ or FASTA format\"}]}, {\"id\": 177, \"name\": \"query_uniprot\", \"description\": \"Query the UniProt REST API using either natural language or a direct endpoint.\", \"optional_parameters\": [{\"name\": \"endpoint\", \"type\": \"str\", \"default\": null, \"description\": \"Full or partial UniProt API endpoint URL to query directly (e.g., 'https://rest.uniprot.org/uniprotkb/P01308')\"}, {\"name\": \"max_results\", \"type\": \"int\", \"default\": 5, \"description\": \"Maximum number of results to return\"}], \"required_parameters\": [{\"name\": \"prompt\", \"type\": \"str\", \"default\": null, \"description\": \"Natural language query about proteins (e.g., \\\"Find information about human insulin\\\")\"}]}, {\"id\": 182, \"name\": \"query_kegg\", \"description\": \"Take a natural language prompt and convert it to a structured KEGG API query.\", \"optional_parameters\": [{\"name\": \"endpoint\", \"type\": \"str\", \"default\": null, \"description\": \"Direct KEGG endpoint to query\"}, {\"name\": \"verbose\", \"type\": \"bool\", \"default\": true, \"description\": \"Return detailed results\"}], \"required_parameters\": [{\"name\": \"prompt\", \"type\": \"str\", \"default\": null, \"description\": \"Natural language query about KEGG data\"}]}, {\"id\": 183, \"name\": \"query_stringdb\", \"description\": \"Query the STRING protein interaction database using natural language or direct endpoint.\", \"optional_parameters\": [{\"name\": \"endpoint\", \"type\": \"str\", \"default\": null, \"description\": \"Full URL to query directly\"}, {\"name\": \"download_image\", \"type\": \"bool\", \"default\": false, \"description\": \"Download image results if endpoint is image\"}, {\"name\": \"output_dir\", \"type\": \"str\", \"default\": null, \"description\": \"Directory to save downloaded files\"}, {\"name\": \"verbose\", \"type\": \"bool\", \"default\": true, \"description\": \"Return detailed results\"}], \"required_parameters\": [{\"name\": \"prompt\", \"type\": \"str\", \"default\": null, \"description\": \"Natural language query about protein interactions\"}]}, {\"id\": 190, \"name\": \"query_geo\", \"description\": \"Query the NCBI GEO database (GDS/GEOPROFILES) using natural language or direct search term.\", \"optional_parameters\": [{\"name\": \"search_term\", \"type\": \"str\", \"default\": null, \"description\": \"Direct GEO search term\"}, {\"name\": \"max_results\", \"type\": \"int\", \"default\": 3, \"description\": \"Maximum number of results\"}], \"required_parameters\": [{\"name\": \"prompt\", \"type\": \"str\", \"default\": null, \"description\": \"Natural language query about expression data\"}]}, {\"id\": 193, \"name\": \"query_ensembl\", \"description\": \"Query the Ensembl REST API using natural language or a direct endpoint.\", \"optional_parameters\": [{\"name\": \"endpoint\", \"type\": \"str\", \"default\": null, \"description\": \"Direct Ensembl endpoint or full URL\"}, {\"name\": \"verbose\", \"type\": \"bool\", \"default\": true, \"description\": \"Return detailed results\"}], \"required_parameters\": [{\"name\": \"prompt\", \"type\": \"str\", \"default\": null, \"description\": \"Natural language query about genomic data\"}]}, {\"id\": 194, \"name\": \"query_opentarget\", \"description\": \"Query the OpenTargets Platform API using natural language or a direct GraphQL query.\", \"optional_parameters\": [{\"name\": \"query\", \"type\": \"str\", \"default\": null, \"description\": \"Direct GraphQL query string\"}, {\"name\": \"variables\", \"type\": \"dict\", \"default\": null, \"description\": \"Variables for GraphQL\"}, {\"name\": \"verbose\", \"type\": \"bool\", \"default\": false, \"description\": \"Return detailed results\"}], \"required_parameters\": [{\"name\": \"prompt\", \"type\": \"str\", \"default\": null, \"description\": \"Natural language query about targets/diseases\"}]}, {\"id\": 200, \"name\": \"query_reactome\", \"description\": \"Query the Reactome database using natural language or a direct endpoint; optionally download pathway diagrams.\", \"optional_parameters\": [{\"name\": \"endpoint\", \"type\": \"str\", \"default\": null, \"description\": \"Direct endpoint or full URL\"}, {\"name\": \"download\", \"type\": \"bool\", \"default\": false, \"description\": \"Download pathway diagram if available\"}, {\"name\": \"output_dir\", \"type\": \"str\", \"default\": null, \"description\": \"Directory to save downloads\"}, {\"name\": \"verbose\", \"type\": \"bool\", \"default\": true, \"description\": \"Return detailed results\"}], \"required_parameters\": [{\"name\": \"prompt\", \"type\": \"str\", \"default\": null, \"description\": \"Natural language query about biological pathways\"}]}, {\"id\": 213, \"name\": \"query_quickgo\", \"description\": \"Query the QuickGO API using natural language or a direct endpoint.\", \"optional_parameters\": [{\"name\": \"endpoint\", \"type\": \"str\", \"default\": null, \"description\": \"Direct QuickGO endpoint or full URL\"}, {\"name\": \"max_results\", \"type\": \"int\", \"default\": 25, \"description\": \"Max results (limit, up to 100)\"}, {\"name\": \"verbose\", \"type\": \"bool\", \"default\": true, \"description\": \"Return detailed results\"}], \"required_parameters\": [{\"name\": \"prompt\", \"type\": \"str\", \"default\": null, \"description\": \"Natural language query about GO terms/annotations\"}]}, {\"id\": 214, \"name\": \"query_encode\", \"description\": \"Query the ENCODE Portal API to locate functional genomics data (experiments, files, biosamples, datasets).\", \"optional_parameters\": [{\"name\": \"endpoint\", \"type\": \"str\", \"default\": null, \"description\": \"Direct ENCODE Portal endpoint or full URL\"}, {\"name\": \"max_results\", \"type\": \"int|str\", \"default\": 25, \"description\": \"Limit for search endpoints (number or 'all')\"}, {\"name\": \"verbose\", \"type\": \"bool\", \"default\": true, \"description\": \"Return detailed results\"}], \"required_parameters\": [{\"name\": \"prompt\", \"type\": \"str\", \"default\": null, \"description\": \"Natural language query about functional genomics data\"}]}, {\"id\": 220, \"name\": \"search_protocols\", \"description\": \"Search protocols.io for public protocols matching a keyword.\", \"optional_parameters\": [], \"required_parameters\": [{\"name\": \"query\", \"type\": \"str\", \"default\": null, \"description\": \"Most important keyword or phrase to search (title, description, authors)\"}]}, {\"id\": 221, \"name\": \"get_protocol_details\", \"description\": \"Retrieve detailed metadata for a specific protocols.io protocol by ID.\", \"optional_parameters\": [{\"name\": \"timeout\", \"type\": \"int\", \"default\": 30, \"description\": \"Request timeout in seconds\"}], \"required_parameters\": [{\"name\": \"protocol_id\", \"type\": \"int\", \"default\": null, \"description\": \"Numeric protocol ID from protocols.io\"}]}, {\"id\": 222, \"name\": \"list_local_protocols\", \"description\": \"List available protocol files in the local biomni/tool/protocols/ directory. Includes protocols from Addgene and Thermo Fisher Scientific.\", \"optional_parameters\": [{\"name\": \"source\", \"type\": \"str\", \"default\": null, \"description\": \"Filter by source directory (e.g., 'addgene' or 'thermofisher'). If None, lists all protocols.\"}], \"required_parameters\": []}, {\"id\": 223, \"name\": \"read_local_protocol\", \"description\": \"Read the contents of a local protocol file from biomni/tool/protocols/. Use list_local_protocols() first to find available protocol filenames.\", \"optional_parameters\": [{\"name\": \"source\", \"type\": \"str\", \"default\": null, \"description\": \"Source directory (e.g., 'addgene' or 'thermofisher'). If None, searches all sources.\"}], \"required_parameters\": [{\"name\": \"filename\", \"type\": \"str\", \"default\": null, \"description\": \"Name of the protocol file (e.g., 'Addgene_ Protocol - How to Run an Agarose Gel.txt')\"}]}], \"know_how\": [{\"id\": \"sgRNA_design_guide\", \"name\": \"sgRNA Design Guide: Three-Tiered Approach\", \"content\": \"# sgRNA Design Guide: Three-Tiered Approach\\n\\n## Citations and Acknowledgments\\n\\n### If you use validated sgRNAs from our database (Option 1):\\n- **Database Source**: Addgene (https://www.addgene.org)\\n- **Citation**: Always cite the original publication associated with each sgRNA using the PubMed ID provided in the database\\n- **Acknowledgment**: \\\"Validated sgRNA sequences obtained from Addgene (https://www.addgene.org/crispr/reference/grna-sequence/)\\\"\\n\\n### If you use CRISPick designs (Option 2):\\n- **Acknowledgment Statement**: \\\"Guide designs provided by the CRISPick web tool of the GPP at the Broad Institute\\\"\\n- **Citation for Cas9 designs (SpCas9, SaCas9)**: Sanson KR, et al. Optimized libraries for CRISPR-Cas9 genetic screens with multiple modalities. Nat Commun. 2018;9(1):5416. PMID: 30575746\\n- **Citation for Cas12a designs (AsCas12a, enAsCas12a)**: DeWeirdt PC, et al. Optimization of AsCas12a for combinatorial genetic screens in human cells. Nat Biotechnol. 2021;39(1):94-104. PMID: 32661438\\n  - Note: This paper describes enAsCas12a optimization; specify which variant you used in your methods\\n\\n## Overview\\n\\nThis guide provides a three-tiered approach to sgRNA design, prioritizing validated sequences before moving to computational predictions. Always start with Option 1 and proceed to subsequent options only if needed.\\n\\n\\n## Option 1: Search Validated sgRNA Sequences (Recommended First)\\n\\n### 1.1 Search for Validated sgRNAs\\n\\n**IMPORTANT**: You MUST complete BOTH Method 1 AND Method 2 before proceeding to Option 2. Do not skip Method 2 even if Method 1 finds no results.\\n\\n#### Method 1: Search Our Database (Fastest)\\n\\nWe maintain a curated database of 300+ validated sgRNA sequences from Addgene with experimental evidence.\\n\\n**Location**: `biomni/know_how/resource/addgene_grna_sequences.csv`\\n\\n**Search the database**:\\n```python\\nimport pandas as pd\\n\\n# Load the database\\ndf = pd.read_csv('addgene_grna_sequences.csv')\\n\\n# Search for your gene\\ngene_name = \\\"TP53\\\"\\nresults = df[df['Target_Gene'].str.upper() == gene_name.upper()]\\n\\n# Filter by species and application\\nresults_filtered = results[\\n    (results['Target_Species'] == 'H. sapiens') &\\n    (results['Application'] == 'cut')  # or 'activate', 'RNA targeting'\\n]\\n\\n# Display results with references\\nprint(results_filtered[['Target_Gene', 'Target_Sequence',\\n                        'Plasmid_ID', 'PubMed_ID', 'Depositor']])\\n```\\n\\n**Database columns**:\\n- `Target_Gene`: Gene symbol\\n- `Target_Species`: Organism (H. sapiens, M. musculus, etc.)\\n- `Target_Sequence`: 20bp sgRNA sequence (5' to 3')\\n- `Application`: cut (knockout), activate (CRISPRa), RNA targeting (CRISPRi)\\n- `Cas9_Species`: S. pyogenes, S. aureus, etc.\\n- `Plasmid_ID`: Addgene plasmid number\\n- `Plasmid_URL`: Direct link to plasmid page\\n- `PubMed_ID`: **Publication reference** (cite this in your work)\\n- `PubMed_URL`: Direct link to paper\\n- `Depositor`: Research lab that contributed the sequence\\n\\n#### Method 2: Advanced Web Search (REQUIRED - Do Not Skip)\\n\\n**CRITICAL**: Even if Method 1 found no results, you MUST perform this literature search before moving to Option 2. Many validated sgRNAs are published in literature but not in the Addgene database.\\n\\nUse `advanced_web_search_claude` from `biomni.tool.literature` to find validated sgRNAs from literature and databases:\\n\\n```python\\nfrom biomni.tool.literature import advanced_web_search_claude\\n\\n# Example usage\\nresults = advanced_web_search_claude(\\\"sgRNA TP53 validated H. sapiens experimental\\\")\\n```\\n\\n**Search queries to try (use multiple):**\\n```\\n\\\"sgRNA\\\" OR \\\"guide RNA\\\" \\\"[GENE_NAME]\\\" validated experimental\\n\\\"CRISPR knockout\\\" \\\"[GENE_NAME]\\\" sgRNA sequence validated\\n\\\"[GENE_NAME]\\\" sgRNA \\\"cutting efficiency\\\" OR \\\"on-target\\\"\\n\\\"[GENE_NAME]\\\" \\\"guide sequence\\\" CRISPR validated\\n```\\n\\n**Example for TP53:**\\n```\\n\\\"sgRNA\\\" \\\"TP53\\\" validated \\\"H. sapiens\\\" experimental\\n\\\"CRISPR knockout\\\" \\\"TP53\\\" guide sequence validated\\n```\\n\\n**What to search for in results:**\\n- Published papers with validated sgRNA sequences\\n- Supplementary materials containing sgRNA sequences\\n- Other CRISPR databases (e.g., GenScript, Horizon Discovery)\\n- Laboratory protocols with specific sgRNA sequences\\n\\n**IMPORTANT**: Spend adequate time searching literature. Look through at least the first 10-15 search results and check supplementary materials of relevant papers.\\n\\n#### What to Do with Results:\\n\\n‚úÖ **If you find matching sgRNAs (from either method):**\\n1. **Record the sgRNA sequence** (20bp target sequence)\\n2. **Note the reference**:\\n   - From database: Use `PubMed_ID` to cite the original paper\\n   - From web search: Record the publication DOI/PubMed ID\\n3. **Record validation details**: Cell line, cutting efficiency, any reported off-targets\\n\\n\\n**Example result format:**\\n```\\nGene: TP53\\nsgRNA sequence: GAGGTTGTGAGGCGCTGCCC\\nSpecies: H. sapiens (human)\\nApplication: Knockout (cut)\\nReference: PubMed ID 24336569 (Ran et al., 2013)\\nValidation: Tested in HEK293T cells, 85% cutting efficiency\\n```\\n\\n‚ùå **If no matches found in BOTH Method 1 AND Method 2:**\\nOnly then proceed to **Option 2: Download CRISPick Dataset**\\n\\n\\n## Option 2: Download Pre-Computed sgRNAs from CRISPick\\n\\n### When to Use This Option?\\n- No validated sgRNAs found in Addgene\\n- Need comprehensive coverage of a gene\\n- Want multiple sgRNA options with predicted scores\\n- Working with genome-scale screening\\n\\n### 2.1 Overview of CRISPick\\n\\n**CRISPick** (from Broad Institute GPP) provides pre-computed sgRNA designs for entire genomes with 238 available datasets covering:\\n- Human (GRCh38, GRCh37)\\n- Mouse (GRCm38, GRCm39)\\n- Dog, Cow, Monkey, and other model organisms\\n- Multiple Cas enzymes (SpCas9, SaCas9, AsCas12a, enAsCas12a)\\n  - **IMPORTANT**: AsCas12a and enAsCas12a are DIFFERENT enzymes\\n  - **AsCas12a**: Wild-type Acidaminococcus sp. Cas12a\\n  - **enAsCas12a**: Enhanced variant with improved activity\\n  - **Critical**: sgRNAs designed for enAsCas12a may NOT work with wild-type AsCas12a\\n  - Always match the dataset to your specific Cas12a variant\\n- Different applications (knockout, activation, inhibition)\\n\\n### 2.2 Find the Download Link\\n\\n**All 238 download links are available in**: `biomni/know_how/resource/CRISPick_download_links.txt`\\n\\n#### Step 1: Understand File Naming Convention\\n\\nFiles are named: `sgRNA_design_{TAXID}_{GENOME}_{CAS}_{APPLICATION}_{ALGORITHM}_{SOURCE}_{DATE}.txt.gz`\\n\\n**Common datasets:**\\n\\n| Organism | Genome | Cas9 | Application | Search Pattern |\\n|-|--||-|-|\\n| Human | GRCh38 | SpCas9 | Knockout | `9606_GRCh38_SpyoCas9_CRISPRko` |\\n| Human | GRCh38 | SpCas9 | Activation | `9606_GRCh38_SpyoCas9_CRISPRa` |\\n| Human | GRCh38 | SaCas9 | Knockout | `9606_GRCh38_SaurCas9_CRISPRko` |\\n| Mouse | GRCm38 | SpCas9 | Knockout | `10090_GRCm38_SpyoCas9_CRISPRko` |\\n| Mouse | GRCm38 | SpCas9 | Activation | `10090_GRCm38_SpyoCas9_CRISPRa` |\\n\\n**Key components:**\\n- **TAXID**: `9606` (Human), `10090` (Mouse), `9615` (Dog), `9913` (Cow)\\n- **CAS**:\\n  - `SpyoCas9` (SpCas9, NGG PAM)\\n  - `SaurCas9` (SaCas9, NNGRRT PAM)\\n  - `AsCas12a` (Wild-type Cas12a, TTTV PAM)\\n  - `enAsCas12a` (Enhanced Cas12a, TTTV PAM)\\n  - **WARNING**: Do NOT use AsCas12a datasets if you have enAsCas12a, and vice versa\\n- **APPLICATION**: `CRISPRko` (knockout), `CRISPRa` (activation), `CRISPRi` (inhibition)\\n\\n#### Step 2: Find Your Download URL\\n\\n```bash\\n# Search the download links file\\ngrep \\\"9606_GRCh38_SpyoCas9_CRISPRko\\\" biomni/know_how/resource/CRISPick_download_links.txt\\n\\n# Or for mouse\\ngrep \\\"10090_GRCm38_SpyoCas9_CRISPRko\\\" biomni/know_how/resource/CRISPick_download_links.txt\\n```\\n\\n#### Step 3: Download and Extract\\n\\n```bash\\n# Copy the URL from download_links.txt, then:\\nwget [PASTE_URL_HERE]\\n\\n# Extract the file\\ngunzip sgRNA_design_*.txt.gz\\n```\\n\\n**File sizes**: Knockout (300-700 MB), Activation (50-100 MB), Summary files (1-3 MB)\\n\\n### 2.4 Understanding the File Format\\n\\nThe `.txt` file is tab-delimited. Column names differ between knockout and activation/inhibition datasets.\\n\\n**Essential Columns (All files):**\\n- **sgRNA Sequence**: The 20bp guide RNA sequence (5' to 3')\\n- **Target Gene Symbol**: Gene name (e.g., \\\"TP53\\\", \\\"BRCA1\\\")\\n- **Combined Rank**: Overall ranking (lower = better) - **Use this by default**\\n- **On-Target Rank**: Ranking by efficiency only (lower = better)\\n- **Off-Target Rank**: Ranking by specificity only (lower = better)\\n- **PAM Sequence**: The PAM sequence (e.g., \\\"AGG\\\", \\\"TGG\\\")\\n\\n**Knockout-specific columns:**\\n- **sgRNA Cut Position (1-based)**: Genomic coordinate of cut site\\n- **Exon Number**: Which exon is targeted\\n- **Target Cut %**: Percentage of protein affected\\n\\n**Activation/Inhibition-specific columns:**\\n- **sgRNA 'Cut' Position**: Position relative to gene\\n- **sgRNA 'Cut' Site TSS Offset**: Distance from transcription start site (bp)\\n- **DHS Score**: DNase hypersensitivity score (for CRISPRa)\\n\\n### 2.5 Extract and Select sgRNAs\\n\\n#### Step 1: Load Data and Filter for Your Gene\\n\\n```python\\nimport pandas as pd\\n\\n# Load the dataset\\ndf = pd.read_csv('sgRNA_design_9606_GRCh38_SpyoCas9_CRISPRko_*.txt',\\n                 sep='\\\\t', low_memory=False)\\n\\n# Filter for your gene\\ngene_name = \\\"TP53\\\"\\ngene_sgrnas = df[df['Target Gene Symbol'] == gene_name].copy()\\n\\nprint(f\\\"Found {len(gene_sgrnas)} sgRNAs for {gene_name}\\\")\\n```\\n\\n#### Step 2: Select Top sgRNAs\\n\\n**Default: Use Combined Rank (balances efficiency and specificity)**\\n```python\\n# Sort by Combined Rank (lower is better)\\ntop_sgrnas = gene_sgrnas.nsmallest(10, 'Combined Rank')\\n\\nprint(top_sgrnas[['sgRNA Sequence', 'Combined Rank',\\n                   'Exon Number', 'sgRNA Cut Position (1-based)']])\\n```\\n\\n**Option A: Prioritize On-Target Efficiency**\\n```python\\n# Sort by On-Target Rank (for maximum cutting efficiency)\\nefficient_sgrnas = gene_sgrnas.nsmallest(10, 'On-Target Rank')\\n```\\n\\n**Option B: Prioritize Off-Target Specificity**\\n```python\\n# Sort by Off-Target Rank (for maximum specificity)\\nspecific_sgrnas = gene_sgrnas.nsmallest(10, 'Off-Target Rank')\\n```\\n\\n#### Step 3: Filter by Custom Criteria (Optional)\\n\\n**Filter by Exon Number:**\\n```python\\n# Target specific exon (e.g., exon 5)\\nexon5_sgrnas = gene_sgrnas[gene_sgrnas['Exon Number'] == 5]\\ntop_exon5 = exon5_sgrnas.nsmallest(5, 'Combined Rank')\\n```\\n\\n**Filter by Genomic Position:**\\n```python\\n# Target specific genomic range\\nposition_filtered = gene_sgrnas[\\n    (gene_sgrnas['sgRNA Cut Position (1-based)'] >= 7572000) &\\n    (gene_sgrnas['sgRNA Cut Position (1-based)'] <= 7575000)\\n]\\n```\\n\\n**Target Early Exons for Knockout:**\\n```python\\n# Get sgRNAs from first 3 exons\\nearly_exons = gene_sgrnas[gene_sgrnas['Exon Number'] <= 3]\\ntop_early = early_exons.nsmallest(10, 'Combined Rank')\\n```\\n\\n**Filter by Target Cut Percentage:**\\n```python\\n# Target sgRNAs that affect significant portion of protein\\nhigh_impact = gene_sgrnas[gene_sgrnas['Target Cut %'] <= 50]  # Cut in first 50%\\ntop_high_impact = high_impact.nsmallest(10, 'Combined Rank')\\n```\\n\\n#### Step 4: Select Multiple sgRNAs for Validation\\n\\n```python\\n# Get top 4 sgRNAs from different exons for redundancy\\nfinal_selection = gene_sgrnas.sort_values('Combined Rank').groupby('Exon Number').head(1).head(4)\\n\\n# Save results\\nfinal_selection.to_csv(f'{gene_name}_selected_sgRNAs.csv', index=False)\\n\\nprint(\\\"\\\\nSelected sgRNAs:\\\")\\nprint(final_selection[['sgRNA Sequence', 'Exon Number', 'Combined Rank']])\\n```\\n\\n### 2.6 What to Do with Results\\n\\n‚úÖ **Once you have selected sgRNAs:**\\n1. Choose **3-4 sgRNAs** (use Combined_Rank by default)\\n\\n‚ùå **If dataset doesn't cover your gene or organism:**\\nProceed to **Option 3: De Novo sgRNA Design**\\n\\n\\n## Option 3: General sgRNA Design Guidelines (Last Resort)\\n\\n### When to Use This Option?\\n- Gene not covered in CRISPick datasets\\n- Non-model organism\\n- Custom design requirements\\n\\n### General Design Rules\\n\\n#### Essential Requirements:\\n1. **Length**:\\n   - 20 bp for SpCas9 and SaCas9\\n   - 23-25 bp for Cas12a variants (AsCas12a, enAsCas12a)\\n2. **PAM sequence**:\\n   - **SpCas9**: Requires **NGG** immediately after target (3' end)\\n   - **SaCas9**: Requires **NNGRRT** immediately after target (3' end)\\n   - **AsCas12a** (wild-type): Requires **TTTV** before target (5' end)\\n   - **enAsCas12a** (enhanced): Requires **TTTV** before target (5' end)\\n   - **CRITICAL**: Guides designed for enAsCas12a may not work with wild-type AsCas12a due to different activity profiles\\n3. **GC content**: 40-60% is optimal\\n4. **Avoid**:\\n   - TTTT sequences (terminates transcription)\\n   - Long runs of same nucleotide (>4 repeats)\\n\\n#### Target Location:\\n- **For knockout**: Target early exons (first 50% of gene)\\n- **For activation**: Target -200 to +1 bp from transcription start site (TSS)\\n- **For inhibition**: Target -50 to +300 bp from TSS\\n\\n#### Best Practices:\\n- **Test 3-4 different sgRNAs** per target gene\\n- Select sgRNAs with high efficiency scores (>0.5) and minimal off-targets\\n- Validate experimentally with Sanger sequencing\\n\\n\\n## Quick Start Examples\\n\\n### Example 1: Knockout TP53 in Human Cells\\n\\n**Step 1**: Check Addgene\\n```python\\ndf = pd.read_csv('addgene_grna_sequences.csv')\\ntp53_results = df[(df['Target_Gene'] == 'TP53') &\\n                  (df['Target_Species'] == 'H. sapiens') &\\n                  (df['Application'] == 'cut')]\\n# Result: Found 0 entries ‚Üí Proceed to Option 2\\n```\\n\\n**Step 2**: Download CRISPick dataset\\n```bash\\n# Download human GRCh38 SpCas9 knockout dataset\\nwget https://portals.broadinstitute.org/gppx/public/sgrna_design/api/downloads/\\\\\\nsgRNA_design_9606_GRCh38_SpyoCas9_CRISPRko_RS3seq-Chen2013+RS3target_NCBI_20241104.txt.gz\\n\\ngunzip sgRNA_design_9606_GRCh38_SpyoCas9_CRISPRko_*.txt.gz\\n```\\n\\n**Step 3**: Extract TP53 sgRNAs\\n```python\\ndf = pd.read_csv('sgRNA_design_9606_GRCh38_SpyoCas9_CRISPRko_*.txt', sep='\\\\t')\\ntp53 = df[df['Gene_Symbol'] == 'TP53']\\ntop_sgrnas = tp53[\\n    (tp53['sgRNA_score'] > 0.6) &\\n    (tp53['Off_target_stringency'] > 0.5)\\n].sort_values('sgRNA_score', ascending=False).head(4)\\n\\nprint(top_sgrnas[['sgRNA_sequence', 'sgRNA_score', 'Exon_ID']])\\n```\\n\\n### Example 2: Activate OCT4 in Human iPSCs\\n\\n**Step 1**: Check Addgene\\n```python\\noct4_results = df[(df['Target_Gene'] == 'OCT4') &\\n                  (df['Application'] == 'activate')]\\n# Found 1 validated sgRNA!\\nprint(oct4_results['Target_Sequence'].values[0])\\n# Use this sequence ‚úÖ\\n```\\n\\n\\n**Remember**: Always start with validated sequences (Option 1), then move to pre-computed designs (Option 2), and only use de novo design (Option 3) when necessary. Testing 3-4 sgRNAs per gene is standard practice regardless of prediction scores.\", \"metadata\": {\"authors\": \"Biomni Team\", \"license\": \"CC BY 4.0\", \"version\": \"1.0\", \"last_updated\": \"November 2025\", \"commercial_use\": \"‚úÖ Allowed\", \"short_description\": \"Comprehensive guide for finding or designing sgRNAs using validated sequences, CRISPick datasets, or de novo design tools.\"}, \"description\": \"Comprehensive guide for finding or designing sgRNAs using validated sequences, CRISPick datasets, or de novo design tools.\"}, {\"id\": \"single_cell_annotation\", \"name\": \"Single Cell RNA-seq Cell Type Annotation\", \"content\": \"# Single Cell RNA-seq Cell Type Annotation\\n\\n\\n## Overview\\n\\nCell type annotation is the process of assigning cell type labels to clusters or individual cells in single-cell RNA-seq data. This guide covers three main approaches and their practical implementation.\\n\\n## Three Annotation Approaches\\n\\n### 1. Manual Marker-Based Annotation\\nIdentify cell types by examining expression of known marker genes in each cluster.\\n\\n**Tools**: Scanpy, Seurat\\n**Best for**: Small datasets, novel cell types, high confidence needs\\n\\n### 2. Automated Annotation\\nUse pre-trained classifiers to automatically assign cell type labels.\\n\\n**Tools**: CellTypist, scAnnotate\\n**Best for**: Standard tissues, quick preliminary annotation, large datasets\\n\\n### 3. Reference-Based Label Transfer\\nTransfer labels from annotated reference datasets to your query data.\\n\\n**Tools**: scArches, scANVI, Azimuth, SingleR\\n**Best for**: Well-characterized tissues, integration with public data\\n\\n## Recommended Workflow\\n\\n### Step 1: Quality Control First\\n- **Remove low-quality cells before annotation**\\n- Filter doublets (expected doublet rate: 0.8% per 1000 cells)\\n- Check for ambient RNA contamination\\n- Verify cluster quality and resolution\\n\\n### Step 2: Initial Marker-Based Assessment\\n\\n```python\\n# Scanpy example\\nimport scanpy as sc\\n\\n# Calculate marker genes for clusters\\nsc.tl.rank_genes_groups(adata, 'leiden', method='wilcoxon')\\n\\n# Visualize top markers\\nsc.pl.rank_genes_groups(adata, n_genes=25, sharey=False)\\n\\n# Plot known markers\\nmarkers = {\\n    'T cells': ['CD3D', 'CD3E', 'CD4', 'CD8A'],\\n    'B cells': ['CD19', 'MS4A1', 'CD79A'],\\n    'Monocytes': ['CD14', 'FCGR3A', 'LYZ'],\\n    'NK cells': ['NCAM1', 'NKG7', 'GNLY']\\n}\\n\\nsc.pl.dotplot(adata, markers, groupby='leiden')\\n```\\n\\n### Step 3: Use Automated Tools for Validation\\n\\n```python\\n# CellTypist example (fast, accurate for immune cells)\\nimport celltypist\\nfrom celltypist import models\\n\\n# Download immune cell model\\nmodel = models.Model.load(model='Immune_All_Low.pkl')\\n\\n# Predict cell types\\npredictions = celltypist.annotate(adata, model=model, majority_voting=True)\\nadata = predictions.to_adata()\\n```\\n\\n### Step 4: Reference-Based Refinement\\n\\n```python\\n# scArches example for label transfer\\nimport scarches as sca\\n\\n# Load pre-trained reference model\\nmodel = sca.models.SCANVI.load_query_data(\\n    adata=adata,  # Your query data\\n    reference_model=\\\"path/to/reference_model\\\"\\n)\\n\\n# Transfer labels\\nmodel.train(max_epochs=100)\\nadata.obs['transferred_labels'] = model.predict()\\n```\\n\\n## Best Practices\\n\\n### Do's:\\n1. **Always combine multiple approaches** - Use marker-based validation even with automated tools\\n2. **Check cluster purity** - Ensure clusters represent single cell types\\n3. **Validate with multiple marker sets** - Don't rely on single markers\\n4. **Consider biological context** - Tissue type, disease state, developmental stage\\n5. **Document confidence levels** - Note uncertain annotations\\n6. **Use hierarchical annotation** - Broad categories first, then subtypes\\n\\n### Don'ts:\\n1. **Don't over-cluster** - Too fine resolution creates artificial distinctions\\n2. **Don't ignore batch effects** - Correct before annotation\\n3. **Don't trust automation blindly** - Always validate predictions\\n4. **Don't mix cell states with cell types** - Activated vs. resting cells are states, not types\\n5. **Don't annotate low-quality cells** - Remove them first\\n\\n## Common Pitfalls\\n\\n### 1. Doublet Clusters\\n**Problem**: Clusters with markers from multiple cell types\\n**Solution**: Use doublet detection tools (Scrublet, DoubletFinder) before annotation\\n\\n### 2. Ambient RNA\\n**Problem**: Background markers in all cells\\n**Solution**: Use SoupX or CellBender for decontamination\\n\\n### 3. Over-interpretation of Small Clusters\\n**Problem**: Rare clusters may be technical artifacts\\n**Solution**: Require minimum cell count (e.g., >25 cells), validate with independent data\\n\\n### 4. Reference Mismatch\\n**Problem**: Reference from different tissue/species/condition\\n**Solution**: Use tissue-matched references, check marker overlap before transfer\\n\\n## Tool Selection Guide\\n\\n| Scenario | Recommended Tool | Why |\\n|----------|------------------|-----|\\n| Immune cells (human) | CellTypist | Pre-trained on large immune atlases |\\n| Mouse tissues | scArches + Mouse Cell Atlas | Comprehensive mouse reference |\\n| Novel cell types | Manual + Scanpy/Seurat | Need domain expertise |\\n| Large datasets (>100k cells) | CellTypist | Fast, scalable |\\n| Cross-species | Manual markers | Limited reference transfer |\\n| Developmental data | scArches | Handles continuous states |\\n\\n## Key Marker Genes by Cell Type\\n\\n### Blood/Immune:\\n- **T cells**: CD3D, CD3E (all T cells); CD4, CD8A (subtypes)\\n- **B cells**: CD19, MS4A1 (CD20), CD79A\\n- **Monocytes/Macrophages**: CD14, CD68, LYZ\\n- **NK cells**: NCAM1 (CD56), NKG7, KLRD1\\n- **Dendritic cells**: FCER1A, CD1C\\n\\n### Epithelial:\\n- **General epithelial**: EPCAM, KRT18, KRT19\\n- **Lung AT1**: AGER, PDPN\\n- **Lung AT2**: SFTPC, SFTPA1\\n- **Intestinal**: VIL1, MUC2\\n\\n### Stromal:\\n- **Fibroblasts**: COL1A1, DCN, LUM\\n- **Endothelial**: PECAM1 (CD31), VWF, CDH5\\n- **Smooth muscle**: ACTA2, MYH11, TAGLN\\n\\n## Validation Checklist\\n\\n- [ ] Cluster purity: >80% cells with same label per cluster\\n- [ ] Marker consistency: Top DE genes match expected markers\\n- [ ] Biological plausibility: Expected proportions for tissue type\\n- [ ] Cross-method agreement: Manual and automated annotations align\\n- [ ] Reference quality: >70% cells successfully transferred\\n- [ ] Doublet check: No clusters with multi-lineage markers\\n- [ ] Documentation: Record confidence levels and uncertain calls\\n\\n## Resources\\n\\n### Tools:\\n- **Scanpy**: https://scanpy.readthedocs.io/\\n- **CellTypist**: https://www.celltypist.org/\\n- **scArches**: https://scarches.readthedocs.io/\\n- **Seurat**: https://satijalab.org/seurat/\\n\\n### References:\\n- **PanglaoDB**: Database of marker genes\\n- **CellMarker**: Curated cell marker database\\n- **Human Cell Atlas**: Reference datasets\\n\\n### Pre-trained Models:\\n- **CellTypist models**: 30+ tissue-specific models\\n- **Azimuth references**: PBMC, lung, kidney, etc.\\n- **scArches models**: Multiple tissue references\\n\\n## Troubleshooting\\n\\n**Issue**: All clusters look similar\\n‚Üí Increase clustering resolution, check if data is normalized\\n\\n**Issue**: Too many small clusters\\n‚Üí Decrease resolution, merge similar clusters based on markers\\n\\n**Issue**: Automated tool gives inconsistent results\\n‚Üí Check input normalization, try multiple tools, fall back to manual\\n\\n**Issue**: Can't find clear markers for cluster\\n‚Üí May be transitional state, doublet, or low-quality cells\\n\\n**Issue**: Reference transfer fails\\n‚Üí Check batch correction, ensure overlapping gene sets, verify tissue match\", \"metadata\": {\"source\": \"https://www.sc-best-practices.org/cellular_structure/annotation.html\", \"authors\": \"Distilled from \\\"Single-cell best practices\\\" by Luecken, M.D. et al.\", \"license\": \"CC BY 4.0\", \"version\": \"1.0\", \"citation\": \"Luecken, M.D., Theis, F.J. et al. (2023). Current best practices in single-cell RNA-seq analysis: a tutorial. Molecular Systems Biology.\", \"affiliations\": \"Helmholtz Munich, Wellcome Sanger Institute, Harvard Medical School, and contributors\", \"last_updated\": \"January 2025\", \"commercial_use\": \"‚úÖ Allowed\", \"short_description\": \"Best practices for annotating cell types in single-cell RNA-seq data using marker-based, automated, and reference-based approaches.\"}, \"description\": \"Best practices for annotating cell types in single-cell RNA-seq data using marker-based, automated, and reference-based approaches.\"}], \"data_lake\": [\"two-hybrid.parquet\", \"McPAS-TCR.parquet\", \"DepMap_OmicsExpressionProteinCodingGenesTPMLogp1.csv\", \"gene_info.parquet\", \"synthetic_rescue.parquet\", \"gtex_tissue_gene_tpm.parquet\", \"marker_celltype.parquet\", \"proteinatlas.tsv\", \"DepMap_CRISPRGeneDependency.csv\", \"synthetic_growth_defect.parquet\", \"sgRNA_KO_SP_mouse.txt\", \"co-fractionation.parquet\", \"msigdb_human_c5_ontology_geneset.parquet\", \"synthetic_lethality.parquet\", \"DisGeNET.parquet\", \"DepMap_CRISPRGeneEffect.csv\", \"sgRNA_KO_SP_human.txt\", \"msigdb_human_c7_immunologic_signature_geneset.parquet\", \"msigdb_human_c2_curated_geneset.parquet\", \"genetic_interaction.parquet\", \"proximity_label-ms.parquet\", \"go-plus.json\", \"msigdb_human_c6_oncogenic_signature_geneset.parquet\", \"msigdb_human_h_hallmark_geneset.parquet\"], \"libraries\": [\"biopython\", \"scanpy\", \"anndata\", \"gget\", \"gseapy\", \"cellxgene-census\", \"pandas\", \"numpy\", \"scipy\", \"scikit-learn\", \"statsmodels\", \"mageck\", \"igraph\", \"flowkit\", \"pysam\", \"h5py\", \"tqdm\"]}\n\n[{'text': 'TOOLS: [0, 1, 2, 3, 4, 5, 6, 7, 25, 45, 46, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 81, 82, 83, 96, 99, 100, 161, 177, 182, 183, 190, 193, 194, 200, 213, 214, 220, 221, 222, 223]\\n\\nDATA_LAKE: [9, 13, 19, 21, 22, 26, 27, 32, 34, 38, 41, 43, 46, 48, 49, 51, 55, 59, 63, 65, 66, 67, 70, 72]\\n\\nLIBRARIES: [0, 2, 4, 10, 12, 14, 28, 29, 30, 31, 34, 52, 53, 64, 17, 41, 42]\\n\\nKNOW_HOW: [0, 1]', 'type': 'text', 'annotations': []}]\n\nObservation:\n{\"messages\": [{\"id\": null, \"name\": null, \"type\": \"human\", \"content\": \"Plan and experience a CRISPR screen to identify genes that regulate T cell exhaustion, measured by the change in T cell receptor (TCR) signaling between acute (interleukin-2 [IL-2] only) and chronic (anti-CD3 and IL-2) stimulation conditions. Generate 32 genes that maximize the perturbation effect.\", \"additional_kwargs\": {}, \"response_metadata\": {}}, {\"id\": null, \"name\": null, \"type\": \"ai\", \"content\": \"<solution>\\nReasoning and approach  \\nYou want a focused CRISPR perturbation screen where the phenotype is not ‚ÄúTCR signaling‚Äù per se, but the *difference* in TCR signaling between acute (IL‚Äë2 only) and chronic (anti‚ÄëCD3 + IL‚Äë2) stimulation. The most informative genes, therefore, are those that (i) drive the chronic-adaptation/exhaustion program (NFAT‚ÜíTOX/NR4A, AP‚Äë1 imbalance, etc.), (ii) implement inhibitory feedback that accumulates during chronic stimulation (ubiquitin ligases, phosphatases, diacylglycerol kinases, SOCS/A20), and (iii) are canonical checkpoint receptors that become functional brakes in chronic contexts. I‚Äôll design a screen around an interaction (‚Äúdifference-in-differences‚Äù) effect and propose 32 genes expected to produce large shifts in that interaction.\\n\\nPlan (checklist)\\n1. [ ] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [ ] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change\\n\\n1) Define the phenotype (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [ ] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nPhenotype definition (practical options):\\n- Primary phenotype (recommended): a flow-cytometry TCR signaling reporter measured after a standardized brief re-stimulation pulse, e.g.  \\n  - pERK (MAPK), pZAP70, pS6 (mTOR output), NFAT nuclear localization, or a transcriptional immediate-early marker such as CD69.  \\n- Key design: measure signaling *the same way* in both arms, then score each perturbation by how much it changes the chronic-vs-acute signaling contrast.\\n\\n2) Screen format (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nRecommended screen structure (small, high-effect, 32 genes):\\n- Perturbation: CRISPR knockout (CRISPRko) in human primary CD8 T cells (most physiologic for exhaustion-like states).  \\n- Library size: 32 genes √ó 4 sgRNAs/gene (typical) + controls  \\n  - Controls: ~10‚Äì20 non-targeting + a few positive controls for ‚Äúreduce signaling in both contexts‚Äù (e.g., proximal TCR genes) if desired.  \\n- Delivery: pooled lentiviral sgRNA into Cas9-expressing T cells or sgRNA + Cas9 RNP approaches; keep infection low to favor 1 perturbation/cell.  \\n- Replication: biological replicates across donors (at least 2‚Äì3 donors) are more valuable than extra technical replicates because exhaustion programs vary by donor.\\n\\n3) Timeline and stimulation arms (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nTwo-arm design (conceptual):\\n- Arm A (Acute reference): IL‚Äë2 only culture (‚Äúrested/expanded, not chronically TCR-driven‚Äù).  \\n- Arm B (Chronic): repeated or sustained anti‚ÄëCD3 stimulation with IL‚Äë2 to induce chronic activation/exhaustion-like adaptation.  \\n- Measurement day: on the same day in both arms, apply an identical short anti‚ÄëCD3 restimulation pulse (or identical stimulation protocol) immediately before signaling readout, so the readout is comparable.\\n\\n4) Sorting/quantification strategy (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nPooled readout:\\n- For each arm (Acute and Chronic), sort cells into at least two bins based on signaling after the standardized pulse:  \\n  - High signaling vs Low signaling (e.g., top ~20‚Äì30% vs bottom ~20‚Äì30% of the chosen marker).  \\n- Sequence sgRNA cassettes from each bin and quantify sgRNA enrichment/depletion.\\n\\n5) Scoring model for ‚Äúchange in signaling between acute and chronic‚Äù (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [‚úì] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nCompute a per-gene interaction score (difference-in-differences):\\n- For each sgRNA (then aggregate to gene), compute:  \\n  - Acute effect = log2( sgRNA abundance in High / Low ) in Acute arm  \\n  - Chronic effect = log2( sgRNA abundance in High / Low ) in Chronic arm  \\n- Interaction (your target metric) = Chronic effect ‚àí Acute effect  \\nInterpretation:\\n- Positive interaction: perturbation specifically increases signaling in chronic relative to acute (candidate ‚Äúexhaustion brake‚Äù genes; KO may preserve signaling under chronic stimulation).  \\n- Negative interaction: perturbation specifically decreases signaling in chronic relative to acute (candidate ‚Äúresilience‚Äù genes; KO worsens chronic signaling collapse).\\n\\n6) 32 genes to maximize expected perturbation of acute‚Üíchronic TCR-signaling change (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [‚úì] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [‚úì] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nGene set (32), organized by mechanism (all human gene symbols):\\n\\nA) Core exhaustion/adaptation transcriptional drivers (large chronic-specific effects expected)\\n1. TOX  \\n2. TOX2  \\n3. NR4A1  \\n4. NR4A2  \\n5. NR4A3  \\n6. BATF  \\n7. IRF4  \\n8. PRDM1  \\n9. IKZF2  \\n10. TBX21  \\n11. EOMES  \\n12. TCF7  \\n13. BACH2  \\n\\nB) Epigenetic/state-stabilizers (often convert chronic stimulation into a stable dysfunctional state)\\n14. DNMT3A  \\n15. TET2  \\n16. EZH2  \\n17. HDAC7  \\n\\nC) TCR negative-feedback enzymes (directly tune signaling amplitude; frequently upweighted in chronic contexts)\\n18. PTPN2  \\n19. PTPN6  \\n20. PTPN11  \\n21. DGKA  \\n22. DGKZ  \\n\\nD) Ubiquitin/termination of activation signaling (chronic stimulation tends to select for strong signal-terminating feedback)\\n23. CBLB  \\n24. ITCH  \\n25. RNF128  \\n\\nE) Inflammatory/TCR pathway brakes that can disproportionately matter in chronic stimulation\\n26. TNFAIP3  \\n27. SOCS1  \\n\\nF) Checkpoint receptors (canonical chronic brakes; KO often shifts chronic signaling strongly)\\n28. PDCD1  \\n29. CTLA4  \\n30. TIGIT  \\n31. LAG3  \\n32. HAVCR2  \\n\\nIf you tell me (i) species (human vs mouse), (ii) CD4 vs CD8, and (iii) which signaling marker you want to sort on (pERK vs NFAT vs CD69, etc.), I can refine the design choices (e.g., which category to overweight) and propose how to prioritize ‚Äúpositive controls‚Äù vs ‚Äúdiscovery‚Äù targets within the same 32-gene library.\\n</solution>\", \"tool_calls\": [], \"usage_metadata\": null, \"additional_kwargs\": {}, \"response_metadata\": {}, \"invalid_tool_calls\": []}], \"next_step\": \"end\"}\n\n[{'text': '<solution>\\nReasoning and approach  \\nYou want a focused CRISPR perturbation screen where the phenotype is not ‚ÄúTCR signaling‚Äù per se, but the *difference* in TCR signaling between acute (IL‚Äë2 only) and chronic (anti‚ÄëCD3 + IL‚Äë2) stimulation. The most informative genes, therefore, are those that (i) drive the chronic-adaptation/exhaustion program (NFAT‚ÜíTOX/NR4A, AP‚Äë1 imbalance, etc.), (ii) implement inhibitory feedback that accumulates during chronic stimulation (ubiquitin ligases, phosphatases, diacylglycerol kinases, SOCS/A20), and (iii) are canonical checkpoint receptors that become functional brakes in chronic contexts. I‚Äôll design a screen around an interaction (‚Äúdifference-in-differences‚Äù) effect and propose 32 genes expected to produce large shifts in that interaction.\\n\\nPlan (checklist)\\n1. [ ] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [ ] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change\\n\\n1) Define the phenotype (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [ ] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nPhenotype definition (practical options):\\n- Primary phenotype (recommended): a flow-cytometry TCR signaling reporter measured after a standardized brief re-stimulation pulse, e.g.  \\n  - pERK (MAPK), pZAP70, pS6 (mTOR output), NFAT nuclear localization, or a transcriptional immediate-early marker such as CD69.  \\n- Key design: measure signaling *the same way* in both arms, then score each perturbation by how much it changes the chronic-vs-acute signaling contrast.\\n\\n2) Screen format (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nRecommended screen structure (small, high-effect, 32 genes):\\n- Perturbation: CRISPR knockout (CRISPRko) in human primary CD8 T cells (most physiologic for exhaustion-like states).  \\n- Library size: 32 genes √ó 4 sgRNAs/gene (typical) + controls  \\n  - Controls: ~10‚Äì20 non-targeting + a few positive controls for ‚Äúreduce signaling in both contexts‚Äù (e.g., proximal TCR genes) if desired.  \\n- Delivery: pooled lentiviral sgRNA into Cas9-expressing T cells or sgRNA + Cas9 RNP approaches; keep infection low to favor 1 perturbation/cell.  \\n- Replication: biological replicates across donors (at least 2‚Äì3 donors) are more valuable than extra technical replicates because exhaustion programs vary by donor.\\n\\n3) Timeline and stimulation arms (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nTwo-arm design (conceptual):\\n- Arm A (Acute reference): IL‚Äë2 only culture (‚Äúrested/expanded, not chronically TCR-driven‚Äù).  \\n- Arm B (Chronic): repeated or sustained anti‚ÄëCD3 stimulation with IL‚Äë2 to induce chronic activation/exhaustion-like adaptation.  \\n- Measurement day: on the same day in both arms, apply an identical short anti‚ÄëCD3 restimulation pulse (or identical stimulation protocol) immediately before signaling readout, so the readout is comparable.\\n\\n4) Sorting/quantification strategy (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nPooled readout:\\n- For each arm (Acute and Chronic), sort cells into at least two bins based on signaling after the standardized pulse:  \\n  - High signaling vs Low signaling (e.g., top ~20‚Äì30% vs bottom ~20‚Äì30% of the chosen marker).  \\n- Sequence sgRNA cassettes from each bin and quantify sgRNA enrichment/depletion.\\n\\n5) Scoring model for ‚Äúchange in signaling between acute and chronic‚Äù (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [‚úì] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nCompute a per-gene interaction score (difference-in-differences):\\n- For each sgRNA (then aggregate to gene), compute:  \\n  - Acute effect = log2( sgRNA abundance in High / Low ) in Acute arm  \\n  - Chronic effect = log2( sgRNA abundance in High / Low ) in Chronic arm  \\n- Interaction (your target metric) = Chronic effect ‚àí Acute effect  \\nInterpretation:\\n- Positive interaction: perturbation specifically increases signaling in chronic relative to acute (candidate ‚Äúexhaustion brake‚Äù genes; KO may preserve signaling under chronic stimulation).  \\n- Negative interaction: perturbation specifically decreases signaling in chronic relative to acute (candidate ‚Äúresilience‚Äù genes; KO worsens chronic signaling collapse).\\n\\n6) 32 genes to maximize expected perturbation of acute‚Üíchronic TCR-signaling change (completed)\\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \\n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \\n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \\n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \\n5. [‚úì] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \\n6. [‚úì] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \\n\\nGene set (32), organized by mechanism (all human gene symbols):\\n\\nA) Core exhaustion/adaptation transcriptional drivers (large chronic-specific effects expected)\\n1. TOX  \\n2. TOX2  \\n3. NR4A1  \\n4. NR4A2  \\n5. NR4A3  \\n6. BATF  \\n7. IRF4  \\n8. PRDM1  \\n9. IKZF2  \\n10. TBX21  \\n11. EOMES  \\n12. TCF7  \\n13. BACH2  \\n\\nB) Epigenetic/state-stabilizers (often convert chronic stimulation into a stable dysfunctional state)\\n14. DNMT3A  \\n15. TET2  \\n16. EZH2  \\n17. HDAC7  \\n\\nC) TCR negative-feedback enzymes (directly tune signaling amplitude; frequently upweighted in chronic contexts)\\n18. PTPN2  \\n19. PTPN6  \\n20. PTPN11  \\n21. DGKA  \\n22. DGKZ  \\n\\nD) Ubiquitin/termination of activation signaling (chronic stimulation tends to select for strong signal-terminating feedback)\\n23. CBLB  \\n24. ITCH  \\n25. RNF128  \\n\\nE) Inflammatory/TCR pathway brakes that can disproportionately matter in chronic stimulation\\n26. TNFAIP3  \\n27. SOCS1  \\n\\nF) Checkpoint receptors (canonical chronic brakes; KO often shifts chronic signaling strongly)\\n28. PDCD1  \\n29. CTLA4  \\n30. TIGIT  \\n31. LAG3  \\n32. HAVCR2  \\n\\nIf you tell me (i) species (human vs mouse), (ii) CD4 vs CD8, and (iii) which signaling marker you want to sort on (pERK vs NFAT vs CD69, etc.), I can refine the design choices (e.g., which category to overweight) and propose how to prioritize ‚Äúpositive controls‚Äù vs ‚Äúdiscovery‚Äù targets within the same 32-gene library.\\n</solution>', 'type': 'text', 'annotations': []}]\n\nObservation:\nend\n</think>\n\n<solution>\nReasoning and approach  \nYou want a focused CRISPR perturbation screen where the phenotype is not ‚ÄúTCR signaling‚Äù per se, but the *difference* in TCR signaling between acute (IL‚Äë2 only) and chronic (anti‚ÄëCD3 + IL‚Äë2) stimulation. The most informative genes, therefore, are those that (i) drive the chronic-adaptation/exhaustion program (NFAT‚ÜíTOX/NR4A, AP‚Äë1 imbalance, etc.), (ii) implement inhibitory feedback that accumulates during chronic stimulation (ubiquitin ligases, phosphatases, diacylglycerol kinases, SOCS/A20), and (iii) are canonical checkpoint receptors that become functional brakes in chronic contexts. I‚Äôll design a screen around an interaction (‚Äúdifference-in-differences‚Äù) effect and propose 32 genes expected to produce large shifts in that interaction.\n\nPlan (checklist)\n1. [ ] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [ ] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change\n\n1) Define the phenotype (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [ ] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nPhenotype definition (practical options):\n- Primary phenotype (recommended): a flow-cytometry TCR signaling reporter measured after a standardized brief re-stimulation pulse, e.g.  \n  - pERK (MAPK), pZAP70, pS6 (mTOR output), NFAT nuclear localization, or a transcriptional immediate-early marker such as CD69.  \n- Key design: measure signaling *the same way* in both arms, then score each perturbation by how much it changes the chronic-vs-acute signaling contrast.\n\n2) Screen format (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [ ] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nRecommended screen structure (small, high-effect, 32 genes):\n- Perturbation: CRISPR knockout (CRISPRko) in human primary CD8 T cells (most physiologic for exhaustion-like states).  \n- Library size: 32 genes √ó 4 sgRNAs/gene (typical) + controls  \n  - Controls: ~10‚Äì20 non-targeting + a few positive controls for ‚Äúreduce signaling in both contexts‚Äù (e.g., proximal TCR genes) if desired.  \n- Delivery: pooled lentiviral sgRNA into Cas9-expressing T cells or sgRNA + Cas9 RNP approaches; keep infection low to favor 1 perturbation/cell.  \n- Replication: biological replicates across donors (at least 2‚Äì3 donors) are more valuable than extra technical replicates because exhaustion programs vary by donor.\n\n3) Timeline and stimulation arms (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [ ] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nTwo-arm design (conceptual):\n- Arm A (Acute reference): IL‚Äë2 only culture (‚Äúrested/expanded, not chronically TCR-driven‚Äù).  \n- Arm B (Chronic): repeated or sustained anti‚ÄëCD3 stimulation with IL‚Äë2 to induce chronic activation/exhaustion-like adaptation.  \n- Measurement day: on the same day in both arms, apply an identical short anti‚ÄëCD3 restimulation pulse (or identical stimulation protocol) immediately before signaling readout, so the readout is comparable.\n\n4) Sorting/quantification strategy (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [ ] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nPooled readout:\n- For each arm (Acute and Chronic), sort cells into at least two bins based on signaling after the standardized pulse:  \n  - High signaling vs Low signaling (e.g., top ~20‚Äì30% vs bottom ~20‚Äì30% of the chosen marker).  \n- Sequence sgRNA cassettes from each bin and quantify sgRNA enrichment/depletion.\n\n5) Scoring model for ‚Äúchange in signaling between acute and chronic‚Äù (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [‚úì] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [ ] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nCompute a per-gene interaction score (difference-in-differences):\n- For each sgRNA (then aggregate to gene), compute:  \n  - Acute effect = log2( sgRNA abundance in High / Low ) in Acute arm  \n  - Chronic effect = log2( sgRNA abundance in High / Low ) in Chronic arm  \n- Interaction (your target metric) = Chronic effect ‚àí Acute effect  \nInterpretation:\n- Positive interaction: perturbation specifically increases signaling in chronic relative to acute (candidate ‚Äúexhaustion brake‚Äù genes; KO may preserve signaling under chronic stimulation).  \n- Negative interaction: perturbation specifically decreases signaling in chronic relative to acute (candidate ‚Äúresilience‚Äù genes; KO worsens chronic signaling collapse).\n\n6) 32 genes to maximize expected perturbation of acute‚Üíchronic TCR-signaling change (completed)\n1. [‚úì] Define the measurable TCR-signaling phenotype and how it will be compared between acute vs chronic stimulation  \n2. [‚úì] Design the CRISPR screen format (cell system, perturbation modality, library structure, controls, sampling/coverage)  \n3. [‚úì] Define the experimental timeline for acute vs chronic stimulation arms and when to measure signaling  \n4. [‚úì] Define the sorting/quantification strategy to convert signaling into a pooled-screen readout  \n5. [‚úì] Define the statistical model that directly scores ‚Äúchange in signaling between acute and chronic‚Äù per gene  \n6. [‚úì] Output 32 gene targets selected to maximize expected perturbation of the acute‚Üíchronic signaling change  \n\nGene set (32), organized by mechanism (all human gene symbols):\n\nA) Core exhaustion/adaptation transcriptional drivers (large chronic-specific effects expected)\n1. TOX  \n2. TOX2  \n3. NR4A1  \n4. NR4A2  \n5. NR4A3  \n6. BATF  \n7. IRF4  \n8. PRDM1  \n9. IKZF2  \n10. TBX21  \n11. EOMES  \n12. TCF7  \n13. BACH2  \n\nB) Epigenetic/state-stabilizers (often convert chronic stimulation into a stable dysfunctional state)\n14. DNMT3A  \n15. TET2  \n16. EZH2  \n17. HDAC7  \n\nC) TCR negative-feedback enzymes (directly tune signaling amplitude; frequently upweighted in chronic contexts)\n18. PTPN2  \n19. PTPN6  \n20. PTPN11  \n21. DGKA  \n22. DGKZ  \n\nD) Ubiquitin/termination of activation signaling (chronic stimulation tends to select for strong signal-terminating feedback)\n23. CBLB  \n24. ITCH  \n25. RNF128  \n\nE) Inflammatory/TCR pathway brakes that can disproportionately matter in chronic stimulation\n26. TNFAIP3  \n27. SOCS1  \n\nF) Checkpoint receptors (canonical chronic brakes; KO often shifts chronic signaling strongly)\n28. PDCD1  \n29. CTLA4  \n30. TIGIT  \n31. LAG3  \n32. HAVCR2  \n\nIf you tell me (i) species (human vs mouse), (ii) CD4 vs CD8, and (iii) which signaling marker you want to sort on (pERK vs NFAT vs CD69, etc.), I can refine the design choices (e.g., which category to overweight) and propose how to prioritize ‚Äúpositive controls‚Äù vs ‚Äúdiscovery‚Äù targets within the same 32-gene library.\n</solution>",
            "tool_calls": [],
            "invalid_tool_calls": [],
            "usage_metadata": null,
            "additional_kwargs": {},
            "response_metadata": {}
        }
    ]
}